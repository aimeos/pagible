import{u as K,N as W,O as E,s as re,P as le,Q as oe,v as L,x as N,R as T,y as A,S as ue,U as ie,z as se,W as de,A as j,B as ce,C as fe,D as me,X as ve,Y as ye,G as Y,Z as q,$ as pe,I as J,a as S,m as $,a0 as he,f as Ve,h as ge,F as Pe,_ as De,b as Fe,o as ke,r as xe}from"./index-D4atDr4B.js";class g{constructor(n,a){this.order=n,this.separator=a}get format(){return this.order.split("").map(n=>`${n}${n}`).join(this.separator).replace("yy","yyyy")}static canBeParsed(n){if(typeof n!="string")return!1;const a=n.toLowerCase();return["y","m","d"].every(l=>a.includes(l))&&["/","-","."].some(l=>n.includes(l))}static parse(n){if(!g.canBeParsed(n))throw new Error(`[${n}] cannot be parsed into date format specification`);const a=n.toLowerCase().split("").filter((u,p,r)=>"dmy".includes(u)&&r.indexOf(u)===p).join(""),l=["/","-","."].find(u=>n.includes(u));return new g(a,l)}}const be=K({inputFormat:{type:String,validator:e=>!e||g.canBeParsed(e)}},"date-format");function we(e,n){const a=W();function l(){const f=n.value??"en-US",h=Intl.DateTimeFormat(f,{year:"numeric",month:"2-digit",day:"2-digit"}).format(a.toJsDate(a.parseISO("1999-12-07"))).replace(/(07)|(٠٧)|(٢٩)|(۱۶)|(০৭)/,"dd").replace(/(12)|(١٢)|(٠٨)|(۰۹)|(১২)/,"mm").replace(/(1999)|(2542)|(١٩٩٩)|(١٤٢٠)|(۱۳۷۸)|(১৯৯৯)/,"yyyy").replace(/[^ymd\-/.]/g,"").replace(/\.$/,"");return g.canBeParsed(h)?h:"mm/dd/yyyy"}const u=E(()=>g.canBeParsed(e.inputFormat)?g.parse(e.inputFormat):g.parse(l()));function p(f){function h(i){const d=i.trim().split(u.value.separator);return{y:Number(d[u.value.order.indexOf("y")]),m:Number(d[u.value.order.indexOf("m")]),d:Number(d[u.value.order.indexOf("d")])}}function w(i){const{y:d,m:y,d:x}=i;return!d||!y||!x||y<1||y>12||x<1||x>31?null:{year:k(d),month:y,day:x}}function k(i){const d=a.getYear(a.date());if(i>100||d%100>=50)return i;const y=~~(d/100)*100;return i<50?y+i:y-100+i}const O=h(f),o=w(O);if(!o)return null;const{year:s,month:v,day:P}=o,C=i=>String(i).padStart(2,"0");return a.parseISO(`${s}-${C(v)}-${C(P)}`)}function r(f){return!!p(f)}function F(f){const h=a.toISO(f).split("T")[0].split("-");return u.value.order.split("").map(w=>h["ymd".indexOf(w)]).join(u.value.separator)}return{isValid:r,parseDate:p,formatDate:F,parserFormat:E(()=>u.value.format)}}const Oe=K({displayFormat:{type:[Function,String],default:void 0},location:{type:String,default:"bottom start"},menu:Boolean,updateOn:{type:Array,default:()=>["blur","enter"]},...be(),...ve({mobile:null}),...me(),...fe({hideActions:!0}),...ce({prependIcon:"$calendar"}),...j(ye({hideHeader:!0,showAdjacentMonths:!0}),["active","location","rounded"])},"VDateInput"),Ce=re()({name:"VDateInput",props:Oe(),emits:{save:e=>!0,cancel:()=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,n){let{emit:a,slots:l}=n;const{t:u,current:p}=le(),r=W(),{isValid:F,parseDate:f,formatDate:h,parserFormat:w}=we(e,p),{mobile:k}=oe(e),O=()=>e.multiple?[]:null,o=L(e,"modelValue",O(),t=>Array.isArray(t)?t.map(c=>r.toJsDate(c)):t&&r.toJsDate(t),t=>Array.isArray(t)?t.map(c=>r.date(c)):t&&r.date(t)),s=L(e,"menu"),v=N(!1),P=N(e.focused),C=T(),i=T(["save"]);function d(t){return typeof e.displayFormat=="function"?e.displayFormat(t):e.displayFormat?r.format(t,e.displayFormat??"keyboardDate"):h(t)}const y=A(()=>{const t=ue(o.value);if(!t.length)return null;if(e.multiple===!0)return u("$vuetify.datePicker.itemsSelected",t.length);if(e.multiple==="range"){const c=t[0],V=t[t.length-1];return!r.isValid(c)||!r.isValid(V)?"":`${d(r.date(c))} - ${d(r.date(V))}`}return r.isValid(o.value)?d(r.date(o.value)):""}),x=A(()=>{if(k.value)return v.value?"text":"none"}),I=A(()=>!e.disabled&&!e.readonly),z=A(()=>e.updateOn.length?!(k.value&&v.value)&&e.readonly:!0);ie(s,t=>{t||(v.value=!1,i.value=["save"])});function G(t){t.key==="Enter"&&((!s.value||!P.value)&&(s.value=!0),e.updateOn.includes("enter")&&R(t.target))}function M(t){t.preventDefault(),t.stopPropagation(),s.value&&k.value?v.value=!0:s.value=!0}function H(){a("cancel"),s.value=!1,v.value=!1}function Q(t){a("save",t),s.value=!1}function X(t){t==null&&(o.value=O())}function Z(t){e.updateOn.includes("blur")&&R(t.target),k.value&&v.value&&!P.value&&(s.value=!1,v.value=!1)}function R(t){let{value:c}=t;if(!c.trim())o.value=O();else if(!e.multiple)F(c)&&(o.value=f(c));else{const V=c.trim().split(/\D+-\D+|[^\d\-/.]+/);if(V.every(F))if(e.multiple==="range"){const[B,b]=V.map(f).toSorted((D,U)=>r.isAfter(D,U)?1:-1);o.value=he(r,B,b)}else o.value=V.map(f)}}return se(()=>{const t=Y.filterProps(e),c=q.filterProps(j(e,["active","location","rounded"])),V=pe(l,["title","header","day","month","year"]),B=J.filterProps(j(e,["placeholder"]));return S(J,$({ref:C},B,{class:e.class,style:e.style,modelValue:y.value,inputmode:x.value,placeholder:e.placeholder??w.value,readonly:z.value,onKeydown:I.value?G:void 0,focused:s.value||P.value,onBlur:Z,validationValue:o.value,"onClick:control":I.value?M:void 0,"onClick:prepend":I.value?M:void 0,"onUpdate:modelValue":X,"onUpdate:focused":b=>P.value=b}),{...l,default:()=>{var b;return Ve(Pe,null,[S(ge,{modelValue:s.value,"onUpdate:modelValue":D=>s.value=D,activator:"parent",minWidth:"0",eager:P.value,location:e.location,closeOnContentClick:!1,openOnClick:!1},{default:()=>[S(Y,$(t,{modelValue:o.value,"onUpdate:modelValue":D=>o.value=D,disabled:i.value,onSave:Q,onCancel:H}),{default:D=>{let{actions:U,model:_,save:ee,cancel:te,isPristine:ae}=D;function ne(m){e.hideActions?(o.value=m,e.multiple||(s.value=!1)):_.value=m,a("save",m),i.value=[]}return S(q,$(c,{modelValue:e.hideActions?o.value:_.value,"onUpdate:modelValue":m=>ne(m),onMousedown:m=>m.preventDefault()}),{...V,actions:e.hideActions?void 0:()=>{var m;return((m=l.actions)==null?void 0:m.call(l,{save:ee,cancel:te,isPristine:ae}))??U()}})}})]}),(b=l.default)==null?void 0:b.call(l)])}})}),de({},C)}}),Ae={components:{VDateInput:Ce},props:{modelValue:{type:[Array,Date,String,null]},config:{type:Object,default:()=>{}},assets:{type:Object,default:()=>{}},readonly:{type:Boolean,default:!1},context:{type:Object}},emits:["update:modelValue","error"],computed:{rules(){return[e=>!this.config.required||!!e||this.$gettext("Value is required")]}},watch:{modelValue:{immediate:!0,handler(e){this.$emit("error",!this.rules.every(n=>n(e??this.config.default??null)===!0))}}}};function Se(e,n,a,l,u,p){const r=xe("v-date-input");return ke(),Fe(r,{rules:p.rules,readonly:a.readonly,"allowed-dates":a.config.allowed,clearable:!a.readonly&&!a.config.required,max:a.config.max,min:a.config.min,multiple:a.config.multiple,placeholder:a.config.placeholder||null,modelValue:a.modelValue??a.config.default??null,"onUpdate:modelValue":n[0]||(n[0]=F=>e.$emit("update:modelValue",F)),density:"comfortable","hide-details":"auto",variant:"outlined","show-adjacent-months":""},null,8,["rules","readonly","allowed-dates","clearable","max","min","multiple","placeholder","modelValue"])}const Be=De(Ae,[["render",Se]]);export{Be as default};
