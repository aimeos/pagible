var bt=Object.defineProperty;var kt=(e,t,n)=>t in e?bt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ge=(e,t,n)=>kt(e,typeof t!="symbol"?t+"":t,n);import{ap as $e,r as re,c as N,o as y,a as f,w as g,F as ue,a5 as We,bj as V,bk as de,R as fe,y as Y,bf as ke,U as Ye,as as $t,b9 as Ve,f as P,b as _,n as pe,l as O,t as D,d as x,_ as ut,L as U,aB as wt,a6 as ct,a3 as ht,a4 as xt,aK as _e,aM as Je,h as Ze,I as Ct,k as S,i as Ge,j as I,ax as He,m as Qe,bl as te,aD as Le,aH as Dt,aI as St,aG as _t,aJ as Et,ay as Ot,az as Pt,a1 as Lt,aw as Tt}from"./index-BX1pNUVh.js";import{U as It,A as Nt,N as Ft}from"./Navigation-4cCICRyu.js";import{P as et}from"./PageDetail-BfCZYCNh.js";import"./ElementListItems-BlvDVBLU.js";import"./vue-draggable-plus-D9PHmOsy.js";var At=!1,Bt=!0;/*!
 * helper-js v3.1.6
 * Author: phphe <phphe@outlook.com> (https://github.com/phphe)
 * Homepage: null
 * Released under the MIT License.
 */function Te(e){return Object.prototype.toString.call(e)==="[object Array]"}function tt(e){return Object.prototype.toString.call(e)==="[object Object]"}function Vt(e){return typeof e=="function"}function Ht(e,t){return e<t?e:t}function gt(e,t){let n,a=0;for(;(n=e.indexOf(t))>-1;)e.splice(n,1),a++;return a}function pt(e){return e[e.length-1]}function Kt(e){return Te(e)?e:[e]}function Ut(e,t){let n=new Set(t);const a={};return n.forEach(s=>{a[s]=e[s]}),a}function zt(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(function*(){if(t.reverse)if(e.length!=null)for(let n=e.length-1;n>=0;n--){const a={value:e[n],index:n};(!t.exclude||!t.exclude(a))&&(yield a)}else if(tt(e)){const n=Object.keys(e);n.reverse();for(const a of n){const s={value:e[a],key:a};(!t.exclude||!t.exclude(s))&&(yield s)}}else throw"Unsupported type";else if(e.length!=null)for(let n=0;n<e.length;n++){const a={value:e[n],index:n};(!t.exclude||!t.exclude(a))&&(yield a)}else if(tt(e))for(const n of Object.keys(e)){const a={value:e[n],key:n};(!t.exclude||!t.exclude(a))&&(yield a)}else throw"Unsupported type"})()}function Mt(e,t,n){e.hasOwnProperty(t)||(e[t]=n)}function ft(e,t){return Object.keys(t).forEach(n=>{Mt(e,n,t[n])}),e}function Rt(e){const t={};return Object.keys(e).forEach(n=>{e[n]!==void 0&&(t[n]=e[n])}),t}function J(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};n=ft({...n},{childrenKey:"children"});const{childrenKey:a}=n,s=Te(e)?e:[e];class r{}const l=(i,d,o)=>{n.reverse&&(i=i.slice(),i.reverse());const u=i.length;for(let h=0;h<u;h++){const c=i[h],p=n.reverse?u-h-1:h,v=o?[...o,p]:[];n.childFirst&&c[a]!=null&&l(c[a],c,v);const $=t(c,p,d,v);if($===!1)throw new r;if($==="skip children")continue;if($==="skip siblings")break;n.childFirst||c[a]!=null&&l(c[a],c,v)}};try{l(s,null,Te(e)?[]:null)}catch(i){if(!(i instanceof r))throw i}}function jt(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a;return J(e,function(){if(t(...arguments))return a={node:arguments.length<=0?void 0:arguments[0],index:arguments.length<=1?void 0:arguments[1],parent:arguments.length<=2?void 0:arguments[2],path:arguments.length<=3?void 0:arguments[3]},!1},n),a}function Wt(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const a=jt(e,t,n);return a==null?void 0:a.node}function mt(e,t){const n={childrenKey:"children"};t&&Object.assign(n,t);const{childrenKey:a,nodeHandler:s}=n,r=new Xe;return r.childrenKey=a,J(e,(l,i,d,o)=>{let u=Object.assign({},l);u[a]&&(u[a]=[]),s&&(u=s(u,{oldNode:l,index:i,parent:d,path:o})),r.set(o,u)},{childrenKey:a}),r.data}class Xe{constructor(){ge(this,"data");ge(this,"childrenKey","children");let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.data=t}get rootChildren(){const{childrenKey:t}=this,{data:n}=this;return Te(n)?n:n[t]}iteratePath(t){var n=this;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(function*(){const{childrenKey:s,rootChildren:r}=n;if(a.reverse){const l=[...n.iteratePath(t,{...a,reverse:!1})];l.reverse();for(const{path:i,node:d}of l)yield{path:i,node:d}}else{let l=[],i=r;for(const d of t){const o=[...l,d],u=i[d];yield{path:o,node:u},l=o,i=u[s]}}})()}getFamily(t){const n=[];for(const{node:a}of this.iteratePath(t))n.push(a);return n}get(t){return pt(this.getFamily(t))}getParentAndIndex(t){const n=t.slice(),a=n.pop();return{parent:this.get(n),index:a,parentPath:n}}getParent(t){return this.getParentAndIndex(t).parent}set(t,n){if(t==null||t.length===0)this.data=n;else{const{childrenKey:a}=this;let{rootChildren:s}=this;const{parent:r,index:l}=this.getParentAndIndex(t);let i;t.length===1?(s||(this.data?this.data[a]=[]:this.data=[]),i=s):(r[a]||(r[a]=[]),i=r[a]),i[l]=n}}delete(t){const{childrenKey:n,rootChildren:a}=this,{parent:s,index:r}=this.getParentAndIndex(t),l=t.length===1?a:s[n],i=l[r];return l.splice(r,1),i}walk(t,n){const{childrenKey:a,data:s}=this;return J(s,t,a,n)}clone(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return mt(this.data),Rt({childrenKey:this.childrenKey,nodeHandler:t.nodeHandler||void 0})}}function nt(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Vt(e)?e(...t):e}function Yt(e,t){return function(){let a,s;try{a=e(...arguments)}catch(r){s=r}finally{}if(s)throw s;return a}}function me(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=[];let a;const s={};let r=s;return{action:function(){for(var d=arguments.length,o=new Array(d),u=0;u<d;u++)o[u]=arguments[u];if(o.length===0)return r===s&&(r=e()),r;if(a||(a=new Zt),!a.has(o)&&(a.set(o,e(...o)),t.capacity!=null)){n.push(o);const h=n.splice(0,n.length-t.capacity);for(const c of h)a.delete(c)}return a.get(o)},clearCache:()=>{a=null,n.splice(0,n.length)}}}function Xt(){let e,t;return{promise:new Promise((a,s)=>{e=a,t=s}),resolve:e,reject:t}}function qt(e,t){for(;;){if(e.parentNode==null)return!1;if(e.parentNode===t)return!0;e=e.parentNode}}function Ke(e){let t=e.getBoundingClientRect();if(document.documentElement.clientTop>0){const n=t.top-document.documentElement.clientTop,a=t.bottom,s=t.left-document.documentElement.clientLeft,r=t.right,l=t.width||r-s,i=t.height||a-n,u={top:n,right:r,bottom:a,left:s,width:l,height:i,x:s,y:n};t={...u,toJSON:()=>u}}return t}function at(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=n&&n.withSelf?e:e.parentElement;for(;a;){const s=n.until&&a===n.until;if(s&&!n.withUntil)return;const r=t(a);if(r==="break")return;if(r)return a;if(s)return;a=a.parentElement}}function Ie(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)}function rt(e,t){for(const n of t)if(Ie(e,n))return!0;return!1}function Z(e,t,n,a){e.addEventListener?e.addEventListener(t,n,a):e.attachEvent&&e.attachEvent(`on${t}`,n,a)}function G(e,t,n,a){e.removeEventListener?e.removeEventListener(t,n,a):e.detachEvent&&e.detachEvent(`on${t}`,n,a)}function Jt(e){let t=[];const n=()=>{if(!s.listening){for(const r of e){Z.apply(this,r);const l=()=>G.apply(this,r);t.push(l)}s.listening=!0}},s={listening:!1,stop:()=>{if(s.listening){for(const r of t)r();t=[],s.listening=!1}},resume:n,start:n};return s.start(),s}function Ne(e,t){return getComputedStyle(e)[t]}function qe(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};n={start:0,end:e.length-1,maxTimes:1e3,...n};let{start:a,end:s}=n;const{returnNearestIfNoHit:r,maxTimes:l}=n;let i,d;a==null&&(a=0,s=e.length-1);let o=0,u;for(;a>=0&&a<=s;){if(o>=l)throw Error(`binarySearch: loop times is over ${l}, you can increase the limit.`);i=Math.floor((s-a)/2+a),d=e[i];const h=o+1;if(u=t(d,i,h),u>0)s=i-1;else if(u<0)a=i+1;else return{index:i,value:d,count:h,hit:!0};o++}return r?{index:i,value:d,count:o+1,hit:!1,greater:u>0}:null}class Zt{constructor(){ge(this,"_map",new Map);ge(this,"_values",{});ge(this,"_objCount",0)}_keysToString(t){const{_map:n}=this;let a=[];for(const s of t){if(!n.has(s))return null;a.push(n.get(s)[0])}return a.toString()}has(t){return this._keysToString(t)!=null}get(t){const{_values:n}=this,a=this._keysToString(t);if(a==null)throw"Value not found by specified keys";return n[a][1]}set(t,n){const{_map:a,_values:s}=this;let r=[];for(const l of t){let i,d=1;a.has(l)?([i,d]=a.get(l),d++):(this._objCount++,i=this._objCount.toString()),a.set(l,[i,d]),r.push(i)}s[r.toString()]=[t.slice(),n]}delete(t){const{_values:n,_map:a}=this,s=this._keysToString(t);if(s==null)throw"Value not found by specified keys";delete n[s];for(const r of t){let[l,i]=a.get(r);i--,i===0?a.delete(r):a.set(r,[l,i])}}clear(){this._map.clear(),this._values={}}*entries(){const{_values:t}=this;for(const n in t){const[a,s]=t[n];yield[a,s]}}count(){return[...this.entries()].length}}/*!
 * @virtual-list/vue
 * Author: phphe <phphe@outlook.com> (https://github.com/phphe)
 * Homepage: https://virtual-list.phphe.com
 * Released under the MIT License.
 */const Gt=$e({props:{table:Boolean}}),vt=(e,t)=>{const n=e.__vccOpts||e;for(const[a,s]of t)n[a]=s;return n},Qt={key:0},en={key:1};function tn(e,t,n,a,s,r){return e.table?(y(),N("table",Qt,[V(e.$slots,"prepend"),P("tbody",null,[V(e.$slots,"default")]),V(e.$slots,"append")])):(y(),N("div",en,[V(e.$slots,"prepend"),V(e.$slots,"default"),V(e.$slots,"append")]))}const nn=vt(Gt,[["render",tn]]),an=$e({components:{VirtualListTable:nn},props:{items:Array,disabled:Boolean,horizontal:Boolean,firstRender:{type:Number,default:10},buffer:{type:Number,default:100},itemKey:{type:[String,Function]},itemSize:{type:Function},table:Boolean},setup(e){const t=fe(0),n=fe(e.firstRender-1),a=Y(()=>{var C;return Ht(n.value,(((C=e.items)==null?void 0:C.length)||1)-1)}),s=fe(0),r=Y(()=>c.value[t.value]?he(t.value):0),l=Y(()=>c.value.length>0?he(c.value.length-1)+pt(h.value):0),i=Y(()=>c.value[a.value]?l.value-he(a.value)-h.value[a.value]:0),d=Y(()=>e.disabled?{}:{overflow:"auto"}),o=Y(()=>{const C={display:"flex"};return e.disabled||(e.horizontal?Object.assign(C,{"margin-left":r.value+"px","margin-right":i.value+"px",width:l.value-i.value-r.value+"px"}):Object.assign(C,{"margin-top":r.value+"px","margin-bottom":i.value+"px"})),C["flex-direction"]=e.horizontal?"row":"column",e.table&&(delete C.display,delete C["flex-direction"]),C}),u=Y(()=>ke((e.items||[]).map(()=>null))),h=Y(()=>(e.items||[]).map((C,k)=>{var b;if(u[k]!=null)return u[k];let B=(b=e.itemSize)==null?void 0:b.call(e,C,k);return B==null&&(B=s.value),B})),c=Y(()=>{const C=[];return h.value.reduce((k,b)=>(C.push(k),k+b),0),C});Ye(()=>e.items,F);const p=Y(()=>{if(!e.items||e.disabled)return;const C=[];for(let k=t.value;k<=a.value;k++){const b=e.items[k];if(!b)break;C.push({item:b,index:k})}return C}),v=fe(),$=fe();$t(async()=>{F();try{Be()}catch{await Ve(),F()}});let E;function A(){const C=v.value;if(!C)return;const k=ae(C);E!=null&&e.buffer-Math.abs(k-E)>=10||(E=k,F())}let H=!1,Q=!1;async function F(){var C;if(H){Q=!0;return}if(!e.items||e.disabled)return;H=!0;const k=v.value,b=(C=$.value)==null?void 0:C.$el;if(!k||!b)return;s.value||(s.value=De()),t.value=xe(),n.value=Ce(),await Ve();let B,X=0;const M={},ie=e.table?b.querySelector("tbody").children:b.children;for(let L=0;L<ie.length;L++){const T=ie[L],K=Ne(T,"position");if(K&&["absolute","fixed"].includes(K))continue;const ee=Ne(T,"display")!=="none"?ce(T):0,se=T.getAttribute("vt-index"),Se=se?parseInt(se):t.value+X;M[Se]=(M[Se]||0)+ee,X++}for(const L of Object.keys(M)){const T=parseInt(L);u.value[T]!==M[T]&&(u.value[T]=M[T],B=!0)}B&&await Ve(),H=!1,Q&&(Q=!1,F());function xe(){const L=ae(k)-z(k)-e.buffer;return qe(c.value,T=>T-L,{returnNearestIfNoHit:!0}).index}function Ce(){const L=ae(k)-z(k)+q(k)+e.buffer;return qe(c.value,T=>T-L,{returnNearestIfNoHit:!0}).index}function De(){const L=[],T=e.table?b.querySelector("tbody").children:b.children;for(let K=0;K<T.length;K++){const ee=T[K],se=getComputedStyle(ee);if(["absolute","fixed"].includes(se.position))continue;const Se=ce(ee);if(L.push(Se),L.length>=10)break}return L.length===0?0:L.reduce((K,ee)=>K+ee,0)/L.length}}function q(C){const k=getComputedStyle(C);let b=parseFloat(e.horizontal?k.width:k.height);return k.boxSizing==="border-box"&&(e.horizontal?b=b-parseFloat(k.borderLeftWidth)-parseFloat(k.borderRightWidth):b=b-parseFloat(k.borderTopWidth)-parseFloat(k.borderBottomWidth)),b}function ce(C){let k=q(C);const b=getComputedStyle(C);return e.horizontal?k+=parseFloat(b.borderLeftWidth)+parseFloat(b.borderRightWidth)+parseFloat(b.marginLeft)+parseFloat(b.marginRight):k+=parseFloat(b.borderTopWidth)+parseFloat(b.borderBottomWidth)+parseFloat(b.marginTop)+parseFloat(b.marginBottom),k=Number.isNaN(k)?0:k,k}function ae(C){return e.horizontal?C.scrollLeft:C.scrollTop}function z(C){const k=getComputedStyle(C);return e.horizontal?parseFloat(k.paddingLeft):parseFloat(k.paddingTop)}function he(C){return c.value[C]}function Be(){const C=v.value;new ResizeObserver(k=>{for(let b of k)if(Ie(b.target,"vtlist")){F();break}}).observe(C)}function we(C,k){if(e.itemKey){if(typeof e.itemKey=="string"&&e.itemKey==="index")return k;if(typeof e.itemKey=="function")return e.itemKey(C,k)}}return{listElRef:v,listInnerRef:$,onscroll:A,listStyle:d,listInnerStyle:o,visibleItemsInfo:p,getItemKey:we,update:F,sizes:h,positions:c,runtimeSizes:u}}});function rn(e,t,n,a,s,r){const l=re("VirtualListTable");return y(),N("div",{class:"vtlist",ref:"listElRef",style:de(e.listStyle),onScrollPassive:t[0]||(t[0]=(...i)=>e.onscroll&&e.onscroll(...i))},[f(l,{class:"vtlist-inner",ref:"listInnerRef",style:de(e.listInnerStyle),table:e.table},{prepend:g(()=>[V(e.$slots,"prepend")]),append:g(()=>[V(e.$slots,"append")]),default:g(()=>[e.disabled?(y(!0),N(ue,{key:0},We(e.items,(i,d)=>V(e.$slots,"default",{key:e.getItemKey(i,d),item:i,index:d})),128)):(y(!0),N(ue,{key:1},We(e.visibleItemsInfo,({item:i,index:d})=>V(e.$slots,"default",{key:e.getItemKey(i,d),item:i,index:d})),128))]),_:3},8,["style","table"])],36)}const sn=vt(an,[["render",rn]]);/*!
 * @he-tree/tree-utils v0.1.0-alpha.5
 * Author: phphe <phphe@outlook.com> (https://github.com/phphe)
 * Homepage: null
 * Released under the MIT License.
 */const oe="children";function ln(e){const n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a={...on,...n,data:e,stats:null,statsFlat:null,_statsMap:null,initialized:!1,init(){const{data:r,childrenKey:l}=this,i=new Xe([]);this._statsMap=new Map,J(r,(o,u,h,c)=>{const p=this.statHandler({...it(),data:o,open:!!this.defaultOpen,parent:i.getParent(c),children:[],level:c.length});this._statsMap.set(o,p),i.set(c,p)},{childrenKey:l});const d=[];i.walk(o=>{d.push(o)}),this.stats=this.statsHandler(i.rootChildren),this.statsFlat=this.statsFlatHandler(d),this.initialized=!0},getStat(r){let l=this._statsMap.get(r);if(!l)throw new st("Stat not found");return l},has(r){if(r.isStat)return this.statsFlat.indexOf(r)>-1;try{return!!this.getStat(r)}catch(l){if(l instanceof st)return!1;throw l}},_getPathByStat(r){if(r==null)return[];const i=this.getSiblings(r).indexOf(r);return[...r.parent?this._getPathByStat(r.parent):[],i]},afterOneCheckChanged(r){const{checked:l}=r;if(r._ignoreCheckedOnce)return delete r._ignoreCheckedOnce,!1;const i=d=>{const{parent:o}=d;if(o){let u,h,c;for(const v of o.children)v.checked?u=!0:v.checked===0?c=!0:h=!0;const p=c?0:h?u?0:!1:!0;o.checked!==p&&(this._ignoreCheckedOnce(o),o.checked=p),i(o)}};return i(r),J(r.children,d=>{d.checked!==l&&(this._ignoreCheckedOnce(d),d.checked=l)},{childrenKey:oe}),!0},_ignoreCheckedOnce(r){r._ignoreCheckedOnce=!0,setTimeout(()=>{r._ignoreCheckedOnce&&(r._ignoreCheckedOnce=!1)},100)},isVisible(r){const l=r.isStat?r:this.getStat(r),i=d=>!d||!d.hidden&&d.open&&i(d.parent);return!!(!l.hidden&&i(l.parent))},updateCheck(){J(this.stats,r=>{if(r.children&&r.children.length>0){const l=r.children.every(i=>i.checked);r.checked!==l&&(this._ignoreCheckedOnce(r),r.checked=l)}},{childFirst:!0,childrenKey:oe})},getChecked(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.statsFlat.filter(l=>l.checked||r&&l.checked===0)},getUnchecked(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this.statsFlat.filter(l=>r?!l.checked:l.checked===!1)},openAll(){for(const r of this.statsFlat)r.open=!0},closeAll(){for(const r of this.statsFlat)r.open=!1},openNodeAndParents(r){const l=r.isStat?r:this.getStat(r);for(const i of this.iterateParent(l,{withSelf:!0}))i.open=!0},_calcFlatIndex(r,l){let i=r?this.statsFlat.indexOf(r)+1:0;const d=r?r.children:this.stats;for(let o=0;o<l;o++)i+=this._count(d[o]);return i},add(r,l,i){if(this.has(r))throw"Can't add because data exists in tree";const d=l?l.children:this.stats;i==null&&(i=d.length);const o=this.statHandler({...it(),open:!!this.defaultOpen,data:r,parent:l||null,children:[],level:l?l.level+1:1});this._setPosition(o,l||null,i);const u=r[this.childrenKey];if(u){const h=u.slice();for(const c of h)this.add(c,o)}},remove(r){const l=this.getSiblings(r);if(l.includes(r)){gt(l,r);const i=this._flat(r);this.statsFlat.splice(this.statsFlat.indexOf(r),i.length);for(const d of i)this._statsMap.delete(d.data);return this.afterRemoveStat(r),!0}return!1},getSiblings(r){const{parent:l}=r;return l?l.children:this.stats},_setPosition(r,l,i){(l?l.children:this.stats).splice(i,0,r),r.parent=l,r.level=l?l.level+1:1;const o=this._calcFlatIndex(l,i),u=this._flat(r);this.statsFlat.splice(o,0,...u);for(const h of u)this._statsMap.has(h.data)||this._statsMap.set(h.data,h);J(r,(h,c,p)=>{p&&(h.level=p.level+1)},{childrenKey:oe}),this.afterSetStat(r,l,i)},*iterateParent(r,l){let i=l!=null&&l.withSelf?r:r.parent;for(;i;)yield i,i=i.parent},move(r,l,i){if(this.has(r)){if(r.parent===l&&this.getSiblings(r).indexOf(r)===i)return!1;if(r===l)throw new Error("Can't move node to it self");if(l&&r.level<l.level){let d;for(const o of this.iterateParent(l))if(o.level===r.level){d=o;break}if(r===d)throw new Error("Can't move node to its descendant")}this.remove(r)}return this._setPosition(r,l,i),!0},_flat(r){const l=[];return J(r,i=>{l.push(i)},{childrenKey:oe}),l},_count(r){return this._flat(r).length},getData(r,l){const{childrenKey:i}=this,d=new Xe([]);return d.childrenKey=i,J(l||this.stats,(o,u,h,c)=>{let p={...o.data,[i]:[]};r&&(p=r(p)),d.set(c,p)},{childrenKey:oe}),d.data}},s=a;return a.noInitialization||s.init(),s}const on={childrenKey:"children",defaultOpen:!1,statsHandler(e){return e},statsFlatHandler(e){return e},afterSetStat(e,t,n){},afterRemoveStat(e){},statHandler(e){return e}};function it(){return{isStat:!0,hidden:!1,checked:!1,style:null,class:null,draggable:null,droppable:null}}class st extends Error{constructor(t){super(t),this.name="StatNotFoundError"}}/*!
 * drag-event-service v2.0.0
 * Author: phphe <phphe@outlook.com> (https://github.com/phphe)
 * Homepage: null
 * Released under the MIT License.
 */const Ee={start:["mousedown","touchstart"],move:["mousemove","touchmove"],end:["mouseup","touchend"]},Ue={isTouch(e){return e.type&&e.type.startsWith("touch")},_getStore(e){return e._wrapperStore||(e._wrapperStore=[]),e._wrapperStore},on(e,t,n,a){const{args:s,mouseArgs:r,touchArgs:l}=lt(a),i=this._getStore(e),d=this,o=function(u){let h;if(d.isTouch(u))h={x:u.changedTouches[0].pageX,y:u.changedTouches[0].pageY,pageX:u.changedTouches[0].pageX,pageY:u.changedTouches[0].pageY,clientX:u.changedTouches[0].clientX,clientY:u.changedTouches[0].clientY,screenX:u.changedTouches[0].screenX,screenY:u.changedTouches[0].screenY};else if(h={x:u.pageX,y:u.pageY,pageX:u.pageX,pageY:u.pageY,clientX:u.clientX,clientY:u.clientY,screenX:u.screenX,screenY:u.screenY},t==="start"&&u.which!==1)return;return n.call(this,u,h)};i.push({handler:n,wrapper:o}),Z.call(null,e,Ee[t][0],o,...s,...r),Z.call(null,e,Ee[t][1],o,...s,...l)},off(e,t,n,a){const{args:s,mouseArgs:r}=lt(a),l=this._getStore(e);for(let i=l.length-1;i>=0;i--){const{handler:d,wrapper:o}=l[i];n===d&&(G.call(null,e,Ee[t][0],o,...s,...r),G.call(null,e,Ee[t][1],o,...s,...r),l.splice(i,1))}}};function lt(e){e||(e={});const t=e.args||[],n=e.mouseArgs||[],a=e.touchArgs||[];return{args:t,mouseArgs:n,touchArgs:a}}/*!
 * @he-tree/dnd-utils v0.1.0-alpha.4
 * Author: phphe <phphe@outlook.com> (https://github.com/phphe)
 * Homepage: null
 * Released under the MIT License.
 */const ze=new Map,ne={triggerElement:null,dragElement:null,internal:!1,dropEffect:"none",preventDefault:!1},W=ne;function ve(e){e.dataTransfer&&(e.dataTransfer.dropEffect=W.dropEffect)}function dn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(ze.has(e))throw"Already registered on specified element";const n={...t},a=n;ft(n,un),Ue.on(e,"start",s,{touchArgs:[{passive:!0}]}),Ue.on(e,"end",r);function s(h){var c;const p=h.target;p.nodeType===Node.ELEMENT_NODE&&(W.triggerElement=p);const v=p;if(n.ingoreHTMLTags&&v.tagName&&n.ingoreHTMLTags.find(E=>E.toUpperCase()===v.tagName))return;const $=(c=n.beforeDragStart)===null||c===void 0?void 0:c.call(n,h);$&&($.setAttribute("draggable","true"),W.dragElement=$)}function r(h){W.dragElement&&W.dragElement.removeAttribute("draggable")}function l(h){var c;W.internal=!0,(c=n.onDragStart)===null||c===void 0||c.call(n,h),ve(h)}function i(h){var c;(c=n.onDrag)===null||c===void 0||c.call(n,h),ve(h)}function d(h){var c;(c=n.onDragEnd)===null||c===void 0||c.call(n,h),W.internal=!1,W.dragElement&&W.dragElement.removeAttribute("draggable"),W.triggerElement=null,W.dragElement=null,W.dropEffect="none"}const o=hn(e,{onDragLeave(h){var c;(c=n.onDragLeave)===null||c===void 0||c.call(n,h),ve(h)},onDragEnter(h){var c;a.ifPreventDefault(h)&&h.preventDefault(),(c=n.onDragEnter)===null||c===void 0||c.call(n,h),ve(h)},onDragOver(h){var c;a.ifPreventDefault(h)&&h.preventDefault(),(c=n.onDragOver)===null||c===void 0||c.call(n,h),ve(h)},onDrop(h){var c;a.ifPreventDefault(h)&&h.preventDefault(),(c=n.onDrop)===null||c===void 0||c.call(n,h)},onEnter(h){var c;(c=n.onEnter)===null||c===void 0||c.call(n,h)},onLeave(h){var c;(c=n.onLeave)===null||c===void 0||c.call(n,h)}});return Z(e,"dragstart",l),Z(e,"drag",i),Z(e,"dragend",d),Object.assign(n,{root:e,destroy:()=>{Ue.off(e,"start",s,{touchArgs:[{passive:!0}]}),G(e,"dragstart",l),G(e,"drag",i),G(e,"dragend",d),o(),ze.delete(e)}}),ze.set(e,a),a}const un={ingoreHTMLTags:["INPUT","TEXTAREA","SELECT","OPTGROUP","OPTION"],ifPreventDefault(e){return ne.dragElement?!0:W.preventDefault},beforeDragStart(e){},onDragStart(e){},onDrag(e){},onDragEnter(e){},onDragLeave(e){},onDragOver(e){},onDragEnd(e){},onDrop(e){}};let Fe=null;const cn=e=>{Fe=e,setTimeout(()=>{Fe=null},20)};function hn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e;let a=!1;const s=p=>{var v;a=!0,(v=t.onEnter)===null||v===void 0||v.call(t,p),u.resume()},r=p=>{var v;cn(p.target),(v=t.onDragEnter)===null||v===void 0||v.call(t,p),a||s(p)},l=p=>{var v;a||s(p),(v=t.onDragOver)===null||v===void 0||v.call(t,p)},i=p=>{var v;(v=t.onDragLeave)===null||v===void 0||v.call(t,p);const $=function(){var A;let H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:p;a=!1,(A=t.onLeave)===null||A===void 0||A.call(t,H),u.stop()},E=Fe;Fe=null,E&&qt(E,n)||$()},d=p=>{var v;(v=t.onDrop)===null||v===void 0||v.call(t,p)},o=p=>{var v;p instanceof KeyboardEvent&&p.key!=="Escape"||(a=!1,u.stop(),(v=t.onEndBeforeLeave)===null||v===void 0||v.call(t,p))},u=Jt([[e,"drop",o],[window,"mouseup",o],[window,"touchend",o],[window,"keydown",o]]);u.stop();const h=()=>{Z(e,"dragenter",r),Z(e,"dragover",l),Z(e,"dragleave",i),Z(e,"drop",d)},c=()=>{G(e,"dragenter",r),G(e,"dragover",l),G(e,"dragleave",i),G(e,"drop",d),u.stop()};return h(),c}/*!
 * @he-tree/vue v2.9.3
 * Author: phphe <phphe@outlook.com> (https://github.com/phphe)
 * Homepage: https://hetree.phphe.com/
 * Released under the MIT License.
 */let Ae=!1;const gn=()=>{Ae=!0,setTimeout(()=>{Ae=!1},100)},pn=$e({props:["stat","rtl","btt","indent","table","treeLine","treeLineOffset","processor"],emits:["open","close","check"],setup(e,{emit:t}){const n=Y(()=>({[e.rtl?"paddingRight":"paddingLeft"]:e.indent*(e.stat.level-1)+"px"}));Ye(()=>e.stat.checked,r=>{Ae||e.processor.afterOneCheckChanged(e.stat)&&t("check",e.stat)}),Ye(()=>e.stat.open,r=>{Ae||(t(r?"open":"close",e.stat),gn())});const a=Y(()=>{const r=[],l=u=>{var h;if(u.parent){let c=(h=u.parent)==null?void 0:h.children.indexOf(u);do{c++;let p=u.parent.children[c];if(p){if(!p.hidden)return!0}else break}while(!0)}return!1},i=e.rtl?"right":"left",d=e.btt?"top":"bottom";let o=e.stat;for(;o;){let u=(o.level-2)*e.indent+e.treeLineOffset;const h=l(o),c=()=>{r.push({style:{[i]:u+"px",[d]:h?0:"50%"}})};o===e.stat?o.level>1&&c():h&&c(),o=o.parent}return r}),s=Y(()=>{let r=(e.stat.level-2)*e.indent+e.treeLineOffset;return{[e.rtl?"right":"left"]:r+"px"}});return{indentStyle:n,vLines:a,hLineStyle:s}}}),yt=(e,t)=>{const n=e.__vccOpts||e;for(const[a,s]of t)n[a]=s;return n},fn={class:"tree-node-inner"},mn={key:1,class:"tree-node",ref:"el"};function vn(e,t,n,a,s,r){return e.table?(y(),N("tr",mn,[V(e.$slots,"default",{indentStyle:e.indentStyle})],512)):(y(),N("div",{key:0,class:pe(["tree-node",{"tree-node--with-tree-line":e.treeLine}]),style:de(e.indentStyle),ref:"el"},[e.treeLine?(y(),N(ue,{key:0},[(y(!0),N(ue,null,We(e.vLines,l=>(y(),N("div",{class:"tree-line tree-vline",style:de(l.style)},null,4))),256)),e.stat.level>1?(y(),N("div",{key:0,class:"tree-line tree-hline",style:de(e.hLineStyle)},null,4)):x("",!0)],64)):x("",!0),P("div",fn,[V(e.$slots,"default",{indentStyle:e.indentStyle})])],6))}const yn=yt(pn,[["render",vn]]);function bn(e,t={}){const n={...t,statHandler(a){return this._statHandler2&&(a=this._statHandler2(a)),Me(t.statHandler,ke(a))},statsHandler(a){return Me(t.statsHandler,ke(a))},statsFlatHandler(a){return Me(t.statsFlatHandler,ke(a))}};return ln(e,n)}function Me(e,t){return e?e(t):t}const kn=$e({components:{VirtualList:sn,TreeNode:yn},props:{value:{required:At,type:Array},modelValue:{required:Bt,type:Array},updateBehavior:{type:String,default:"modify"},processor:{type:Object,default:()=>bn([],{noInitialization:!0})},childrenKey:{type:String,default:"children"},textKey:{type:String,default:"text"},indent:{type:Number,default:20},virtualization:{type:Boolean,default:!1},virtualizationPrerenderCount:{type:Number,default:20},defaultOpen:{type:Boolean,default:!0},statHandler:{type:Function},rtl:{type:Boolean,default:!1},btt:{type:Boolean,default:!1},table:{type:Boolean,default:!1},watermark:{type:Boolean,default:!1},nodeKey:{type:[String,Function],default:"index"},treeLine:{type:Boolean,default:!1},treeLineOffset:{type:Number,default:8}},emits:["update:modelValue","click:node","open:node","close:node","check:node","beforeDragStart","before-drag-start","after-drop","change","enter","leave"],data(){return{stats:[],statsFlat:[],dragNode:null,dragOvering:!1,placeholderData:{},placeholderColspan:1,batchUpdateWaiting:!1,self:this,_ignoreValueChangeOnce:!1}},computed:{valueComputed(){return this.modelValue||[]},visibleStats(){const{statsFlat:e,isVisible:t}=this;let n=e;return this.btt&&(n=n.slice(),n.reverse()),n.filter(a=>t(a))},rootChildren(){return this.stats}},methods:{_emitValue(e){this.$emit("update:modelValue",e)},_updateValue(e){return this.updateBehavior==="disabled"?!1:(e!==this.valueComputed&&(this._ignoreValueChangeOnce=!0),this._emitValue(e),!0)},getStat:Re(R("getStat")),has:Re(R("has")),updateCheck:R("updateCheck"),getChecked:R("getChecked"),getUnchecked:R("getUnchecked"),openAll:R("openAll"),closeAll:R("closeAll"),openNodeAndParents:R("openNodeAndParents"),isVisible:R("isVisible"),move:ot("move"),add:Re(ot("add")),addMulti(e,t,n){this.batchUpdate(()=>{let a=n;for(const s of e)this.add(s,t,a),a!=null&&a++})},remove:R("remove"),removeMulti(e){let t=[...e];this.batchUpdate(()=>{for(const n of t)this.remove(n)})},iterateParent:R("iterateParent"),getSiblings:R("getSiblings"),getData:R("getData"),getRootEl(){return this.$refs.vtlist.listElRef},batchUpdate(e){const t=this.ignoreUpdate(e);return this.batchUpdateWaiting||this._updateValue(this.updateBehavior==="new"?this.getData():this.valueComputed),t},ignoreUpdate(e){const t=this.batchUpdateWaiting;this.batchUpdateWaiting=!0;const n=e();return this.batchUpdateWaiting=t,n}},watch:{processor:{immediate:!0,handler(e){if(e){const t=n=>{if(n){const{childrenKey:a}=this;return n[a]||(n[a]=[]),n[a]}else return this.valueComputed};e._statHandler2=this.statHandler?n=>n.data===this.placeholderData?n:this.statHandler(n):null,e.afterSetStat=(n,a,s)=>{const{childrenKey:r,updateBehavior:l}=this;let i=this.valueComputed;if(l==="new"){if(this.batchUpdateWaiting)return;i=this.getData()}else if(l==="modify"){const d=t(a==null?void 0:a.data);d.includes(n.data)||d.splice(s,0,n.data)}this.batchUpdateWaiting||this._updateValue(i)},e.afterRemoveStat=n=>{var a;const{childrenKey:s,updateBehavior:r}=this;let l=this.valueComputed;if(r==="new"){if(this.batchUpdateWaiting)return;l=this.getData()}else if(r==="modify"){const i=t((a=n.parent)==null?void 0:a.data);gt(i,n.data)}this.batchUpdateWaiting||this._updateValue(l)}}e.initialized||(e.data=this.valueComputed,Object.assign(e,Ut(this,["childrenKey","defaultOpen"])),e.init(),e.updateCheck()),this.stats=e.stats,this.statsFlat=e.statsFlat,e.data!==this.valueComputed&&this._updateValue(e.data)}},valueComputed:{handler(e){if(this.dragOvering||this.dragNode||this._ignoreValueChangeOnce)this._ignoreValueChangeOnce=!1;else{const{processor:t}=this;t.data=e,t.init(),this.stats=t.stats,this.statsFlat=t.statsFlat}}}},created(){},mounted(){typeof window<"u"&&(this.watermark===!1&&(window._heTreeWatermarkDisabled=!0),this.watermark&&!window._heTreeWatermarkDisabled&&(window._heTreeWatermark||(window._heTreeWatermark=!0,console.log("%c[he-tree] Vue tree component:  https://hetree.phphe.com","color:#0075ff; font-size:14px;"))))}});function R(e){return function(...t){return this.processor[e](...t)}}function ot(e){return function(...t){return this.batchUpdate(()=>this.processor[e](...t))}}function Re(e){return function(t,...n){return t&&(t=ke(t)),e.call(this,t,...n)}}const $n={key:0,class:"drag-placeholder he-tree-drag-placeholder"},wn=["colspan"],xn={class:"drag-placeholder he-tree-drag-placeholder"};function Cn(e,t,n,a,s,r){const l=re("TreeNode"),i=re("VirtualList");return y(),_(i,{class:pe(["he-tree",{"he-tree--rtl rtl":e.rtl,"he-tree--drag-overing drag-overing":e.dragOvering}]),ref:"vtlist",items:e.visibleStats,disabled:!e.virtualization,table:e.table,itemKey:e.nodeKey},{prepend:g(()=>[V(e.$slots,"prepend",{tree:e.self})]),default:g(({item:d,index:o})=>[f(l,{"vt-index":o,class:pe([d.class,{"drag-placeholder-wrapper":d.data===e.placeholderData,"dragging-node":d===e.dragNode}]),style:de(d.style),stat:d,rtl:e.rtl,btt:e.btt,indent:e.indent,table:e.table,treeLine:e.treeLine,treeLineOffset:e.treeLineOffset,processor:e.processor,onClick:u=>e.$emit("click:node",d),onOpen:t[0]||(t[0]=u=>e.$emit("open:node",u)),onClose:t[1]||(t[1]=u=>e.$emit("close:node",u)),onCheck:t[2]||(t[2]=u=>e.$emit("check:node",u))},{default:g(({indentStyle:u})=>[d.data===e.placeholderData?(y(),N(ue,{key:0},[e.table?(y(),N("td",{key:1,style:de(u),colspan:e.placeholderColspan},[P("div",xn,[V(e.$slots,"placeholder",{tree:e.self})])],12,wn)):(y(),N("div",$n,[V(e.$slots,"placeholder",{tree:e.self})]))],64)):V(e.$slots,"default",{key:1,node:d.data,stat:d,indentStyle:u,tree:e.self},()=>[O(D(d.data[e.textKey]),1)])]),_:2},1032,["vt-index","class","style","stat","rtl","btt","indent","table","treeLine","treeLineOffset","processor","onClick"])]),append:g(()=>[V(e.$slots,"append",{tree:e.self})]),_:3},8,["class","items","disabled","table","itemKey"])}const Dn=yt(kn,[["render",Cn]]);let w=null,m=null,Pe,be,le,Oe,je,j,dt;const ye={get startInfo(){return Pe},get targetInfo(){return be}},Sn=$e({extends:Dn,props:{triggerClass:{type:[String,Array]},disableDrag:Boolean,disableDrop:Boolean,eachDraggable:{type:Function},eachDroppable:{type:Function},rootDroppable:{type:[Boolean,Function],default:!0},dragOpen:{type:Boolean,default:!0},dragOpenDelay:{type:Number,default:0},beforeDragOpen:{type:Function},resolveStartMovePoint:{type:[String,Function]},keepPlaceholder:{type:Boolean},maxLevel:{type:Number},dragCopy:{type:Boolean},dragCopyDataHandler:{type:Function},onExternalDragOver:{type:Function},externalDataHandler:{type:Function},ondragstart:{type:Function}},data(){return{treeDraggableInstance:null}},computed:{},methods:{getNodeByElement(e){const t=e.getAttribute("vt-index");return t==null?null:this.visibleStats[t]},isDraggable(e){if(this.disableDrag)return!1;if(e.draggable!=null)return e.draggable;if(this.eachDraggable){const n=this.eachDraggable(e);if(n!=null)return n}const{parent:t}=e;return t?this.isDraggable(t):!0},isDroppable(e){if(this.disableDrop)return!1;if(!e)return nt(this.rootDroppable,[this,w]);if(e.droppable!=null)return e.droppable;if(this.eachDroppable){const n=this.eachDroppable(e);if(n!=null)return n}const{parent:t}=e;return t?this.isDroppable(t):!0},_eachDroppable(){var e;return nt((e=this._isDragCopy)==null?void 0:e.call(this),[this])}},mounted(){const e=(o,u)=>{let h=!0;return w&&w!==this&&(h=h&&this._isMoved),this.table&&!this._isDragCopy&&(h=h&&this._isDragCopy),h&&(o.x!==u.x||o.y!==u.y)},t=(o,u)=>{m.ignoreUpdate(()=>{if(!m.has(m.placeholderData)){if(m.table){let c=0;const p=m.getRootEl().querySelector("tr");if(p)for(const{value:v}of zt(p.children))Ne(v,"display")!=="none"&&(c+=v.colSpan||1);c<1&&(c=1),m.placeholderColspan=c}m.add(m.placeholderData)}const h=m.getStat(m.placeholderData);m.move(h,o,u)})},n=()=>{const o=this;if(o.has(o.placeholderData))return o.remove(o.getStat(o.placeholderData)),!0},a=o=>{o?ne.dropEffect=w!=null&&w.dragCopy?"copy":"move":ne.dropEffect="none"},s=o=>{const u=this;o?a(!0):u.keepPlaceholder?u.has(u.placeholderData)||a(!1):(n(),a(!1))};let r={x:0,y:0};const l=this.getRootEl();let i=null;const d=()=>{m!=null&&m.has(m.placeholderData)&&m.ignoreUpdate(()=>{m.remove(m.getStat(m.placeholderData)),w&&(w.dragNode.hidden=!1,w.dragOvering=!1)})};this.treeDraggableInstance=dn(l,{beforeDragStart:o=>{if(!ne.triggerElement)return;let u=this.triggerClass;(!u||u.length===0)&&(u="tree-node");let h=Kt(u),c=at(ne.triggerElement,p=>{if(rt(p,h))return!0;if(Ie(p,"tree-node"))return"break"},{withSelf:!0,until:l});if(i=at(c,p=>{if(Ie(p,"tree-node"))return!0},{withSelf:!0,until:l}),!!i){if(j=this.getNodeByElement(i),!j)throw"Can't find drag node";if(this.isDraggable(j))return this.$emit("before-drag-start",j),this.$emit("beforeDragStart",j),l}},onDragStart:o=>{var u,h,c;if(!i||!j)return;{const{x:$,y:E}=i.getBoundingClientRect(),{clientX:A,clientY:H}=o;(u=o.dataTransfer)==null||u.setDragImage(i,A-$,H-E)}je={x:o.clientX,y:o.clientY},w=this,w.dragNode=j,Oe=(()=>{if(this.resolveStartMovePoint==="mouse")return{x:o.clientX,y:o.clientY};if(typeof this.resolveStartMovePoint=="function")return this.resolveStartMovePoint(i);{let $,E=0;if(this.table){let A=i.getBoundingClientRect();$={x:A.x,y:A.y},this.rtl&&($.x=A.right),E=A.height}else if(!this.rtl)$=i.children[0].getBoundingClientRect().toJSON(),E=$.height;else{const A=i.children[0].getBoundingClientRect();$={x:A.right,y:A.y},E=A.height}return this.btt&&($.y+=E),$}})(),this.dragOvering=!0;const p=w.getSiblings(w.dragNode),v=p.indexOf(j);Pe={tree:w,dragNode:j,parent:j.parent,siblings:p,indexBeforeDrop:v},m=this,(h=o.dataTransfer)==null||h.setData("text",`he-tree drag start at ${new Date().toISOString()}`),w._eachDroppable()||setTimeout(()=>{j.hidden=!0,t(j.parent,v+1)},0),(c=this.ondragstart)==null||c.call(this,o)},onEnter:o=>{this.$emit("enter",o)},onLeave:o=>{le=null,this.dragOvering=!1,ne.preventDefault=!1,n(),this.$emit("leave",o)},onDragOver:Yt(o=>{if(!w){if(!this.onExternalDragOver||this.onExternalDragOver(o)===!1)return;ne.preventDefault=!0}const u={x:o.clientX,y:o.clientY},h=e(u,r);if(r=u,!h)return;this.dragOvering=!0,m=this;const c=Oe?{x:Oe.x+(u.x-je.x),y:Oe.y+(u.y-je.y)}:{...u},{btt:p,rtl:v}=m;if(m.disableDrop){ne.dropEffect="none";return}let $,E;const A=m.getRootEl().querySelectorAll(".tree-node"),H=[];A.forEach(b=>{!rt(b,["drag-placeholder-wrapper","dragging-node"])&&Ne(b,"display")!=="none"&&H.push(b)});const Q=qe(H,b=>Ke(b)[p?"bottom":"top"]-c.y,{returnNearestIfNoHit:!0});let F=null,q,ce;Q.hit||(Q.greater?p||(F=Q.index-1,H[F]||F++):p&&(F=Q.index+1,H[F]||F--)),F==null&&(F=Q.index),q=H[F],ce=p?H[F-1]:H[F+1],$=q&&m.getNodeByElement(q),E=ce&&m.getNodeByElement(ce);const{indent:ae}=m,z=me(()=>{if(m.table){let b=Ke(q).toJSON();const B=ae*($.level-1);return v?(b.width-=B,b.right-=B):b.x+=B,b}else return Ke(q.firstElementChild)}).action,he=me(()=>p?c.y>z().y+z().height/2:c.y<z().y+z().height/2).action,Be=me(()=>p?!q||F===H.length-1&&he():!q||F===0&&he()).action,we=me(()=>v?c.x-(z().x+z().width):z().x-c.x).action,C=me(()=>v?c.x<z().x+z().width-ae:c.x>z().x+ae).action;let k;if(Be())k=1,$=null;else if($)we()>0?k=$.level-Math.ceil(we()/ae):C()?k=$.level+1:k=$.level;else return;E&&k<E.level&&(k=E.level),(async()=>{let b,B,X=!1,M=null;const ie=async L=>{if(L.open)return!0;if(m.dragOpen)if(m.dragOpenDelay)if(M=L,le===L)X=!0;else{let T=Xt();le=L;const K=L;return setTimeout(async()=>{K!==le?(X=!0,T.resolve(!0)):(m.beforeDragOpen&&await m.beforeDragOpen(L),K!==le?(X=!0,T.resolve(!0)):(L.open=!0,M=null,T.resolve(!0)))},m.dragOpenDelay),await T.promise}else return m.beforeDragOpen&&await m.beforeDragOpen(L),L.open=!0,!0;else return!1},xe=async()=>{if(m.isDroppable($)&&await ie($)){if(X)return;b=$,B=null}else return!1},Ce=(L=k)=>{let T=$,K=[];for(;T&&T.level>=L;)T=T.parent||null,K.unshift(T);let ee=0;for(const se of K){if(m.isDroppable(se))return b=se,B=K[ee+1]||$,!0;ee++}return!1};dt=$||null,$?k>$.level?await xe()===!1&&Ce($.level):Ce()===!1&&await xe():m.isDroppable(null)&&(b=null),le=M;const De=!!(!X&&(b||b===null));return{cancelled:X,success:De,parent:b,index:De?B?(b?b.children:m.stats).filter(L=>L.data!==m.placeholderData).indexOf(B)+1:0:-1}})().then(b=>{if(!b.cancelled){if(!b.success){s(!1);return}if(m.maxLevel!=null&&m.maxLevel>0){let B=1;if(w){const X=w.dragNode;let M=0;J(X,ie=>{ie.level>M&&(M=ie.level)},{childrenKey:oe}),B=M-X.level+1}if(B+(b.parent?b.parent.level:0)>m.maxLevel){s(!1);return}}s(!0),t(b.parent,b.index)}})}),onDrop:o=>{m=this;const u=!w;if(!m)return;const h=w==null?void 0:w.dragNode;let c,p=(()=>{var v;let $=!0;if(!m.has(m.placeholderData))$=!1;else if(u)c=(v=this.externalDataHandler)==null?void 0:v.call(this,o),$=c!=null;else if(!w.dragCopy){const E=m.getStat(m.placeholderData);w===m&&E.parent===h.parent&&Wt(h,A=>A===E)}return $})();if(p){const v=m.getStat(m.placeholderData),$=m.getSiblings(v);be={tree:m,dragNode:h,parent:v.parent,siblings:$,indexBeforeDrop:$.indexOf(v)}}(()=>{if(d(),p){let v=be.indexBeforeDrop;w&&!w.dragCopy&&w===m&&Pe.parent==be.parent&&Pe.indexBeforeDrop<v&&v--,w&&w!==m&&!w._eachDroppable()&&w.batchUpdate(()=>{w.remove(h),w.updateCheck()}),m.batchUpdate(()=>{let $=w==null?void 0:w.dragNode,E;c?E=c:w._eachDroppable()&&(E=mt(w.dragNode.data,{childrenKey:w.childrenKey}),w.dragCopyDataHandler&&(E=w.dragCopyDataHandler(E))),E&&(m.add(E),$=m.getStat(E)),m.move($,be.parent,v),m.updateCheck()})}m.$emit("after-drop"),p&&(w&&(w.dragCopy||w.$emit("change")),m!==w&&m.$emit("change"))})()},onDragEnd:o=>{d(),w&&(w.dragNode&&(w.dragNode.hidden=!1),w.dragNode=null,w.dragOvering=!1,w=null),m=null,le=null,j=null,dt=null}})},unmounted(){var e;(e=this.treeDraggableInstance)==null||e.destroy()}}),_n={components:{Draggable:Sn},props:{embed:{type:Boolean,default:!1},filter:{type:Object,default:()=>({})}},emits:["select"],inject:["debounce"],data(){return{menu:{},items:[],loading:!0,checked:null,clip:null,term:""}},setup(){const e=wt(),t=ct(),n=ht();return{app:xt(),auth:n,languages:e,messages:t}},created(){this.searchd=this.debounce(this.search,500),this.fetch().then(e=>{this.items=e.data,this.loading=!1})},mounted(){this.checked=!1},computed:{canTrash(){var e;return this.isChecked&&((e=this.$refs.tree)==null?void 0:e.statsFlat.some(t=>t._checked&&!t.data.deleted_at))},isChecked(){var e;return this.checked||((e=this.$refs.tree)==null?void 0:e.statsFlat.some(t=>t._checked))},isTrashed(){var e;return this.isChecked&&((e=this.$refs.tree)==null?void 0:e.statsFlat.some(t=>t._checked&&t.data.deleted_at))}},methods:{add(){if(this.embed||!this.auth.can("page:add")){this.messages.add(this.$gettext("Permission denied"),"error");return}const e=this.create();this.$apollo.mutate({mutation:U`mutation ($input: PageInput!) {
            addPage(input: $input) {
              id
            }
          }`,variables:{input:e}}).then(t=>{if(t.errors)throw t.errors;if(!t.data.addPage)throw new Error("No data in addPage mutation result");const n={...t.data.addPage};this.$refs.tree.add(n),this.$emit("select",n)}).catch(t=>{this.messages.add(this.$gettext("Error adding root page")+`:
`+t,"error"),this.$log("PageList::add(): Error adding root page",t)})},change(){if(!this.auth.can("page:move")){this.messages.add(this.$gettext("Permission denied"),"error");return}const e=ye.targetInfo.parent,n=ye.targetInfo.siblings[ye.targetInfo.indexBeforeDrop+1]||null;this.$apollo.mutate({mutation:U`mutation ($id: ID!, $parent: ID, $ref: ID) {
            movePage(id: $id, parent: $parent, ref: $ref) {
              id
            }
          }`,variables:{id:ye.startInfo.dragNode.data.id,parent:e?e.data.id:null,ref:n?n.data.id:null}}).then(a=>{if(a.errors)throw a.errors;const s=ye.startInfo.parent;s!=null&&s.data&&!(s!=null&&s.children.length)&&(s.data.has=!1),e&&(e.data.has=!0)}).catch(a=>{this.messages.add(this.$gettext("Error moving page")+`:
`+a,"error"),this.$log("PageList::change(): Error moving page",a)})},copy(e,t){this.clip={type:"copy",node:t,stat:e}},create(e={}){return Object.assign({path:"_"+Math.floor(Math.random()*1e4),lang:this.$vuetify.locale.current||this.languages.default(),status:0,cache:5},e)},cut(e,t){this.$refs.tree.statsFlat.forEach(n=>{delete n.cut}),e.cut=!0,this.clip={type:"cut",node:t,stat:e}},drop(e){if(!this.auth.can("page:drop")){this.messages.add(this.$gettext("Permission denied"),"error");return}const t=e?[e]:this.$refs.tree.statsFlat.filter(n=>{var a;return n._checked&&((a=n.data)==null?void 0:a.id)});t.length&&this.$apollo.mutate({mutation:U`mutation ($id: [ID!]!) {
            dropPage(id: $id) {
              id
            }
          }`,variables:{id:t.map(n=>n.data.id)}}).then(n=>{if(n.errors)throw n.errors;for(const a of t)this.update(a,s=>{s.data.deleted_at=new Date().toISOString().replace(/T/," ").substring(0,19),s.check=!1});this.invalidate()}).catch(n=>{this.messages.add(this.$gettext("Error trashing page")+`:
`+n,"error"),this.$log("PageList::drop(): Error trashing page",t,n)})},fetch(e=null,t=1,n=100){if(!this.auth.can("page:view"))return this.messages.add(this.$gettext("Permission denied"),"error"),Promise.resolve([]);const a=this.filter.publish||null,s=this.filter.trashed||"WITHOUT",r={...this.filter};return delete r.trashed,delete r.publish,delete r.view,r.parent_id=e,this.$apollo.query({query:U`query($filter: PageFilter, $limit: Int!, $page: Int!, $trashed: Trashed, $publish: Publish) {
            pages(filter: $filter, first: $limit, page: $page, trashed: $trashed, publish: $publish) {
              data {
                ${this.fields()}
              }
              paginatorInfo {
                currentPage
                lastPage
              }
            }
          }`,variables:{filter:r,page:t,limit:n,trashed:s,publish:a}}).then(l=>{if(l.errors)throw l.errors;return this.transform(l.data.pages)}).catch(l=>{this.messages.add(this.$gettext("Error fetching pages")+`:
`+l,"error"),this.$log("PageList::fetch(): Error fetching page",e,t,n,l)})},fields(){return`id
          parent_id
          created_at
          deleted_at
          editor
          has
          latest {
            id
            published
            publish_at
            data
            editor
            created_at
          }`},hydrate(e){var n,a,s,r,l;const t=(n=e.latest)!=null&&n.data?JSON.parse(e.latest.data):{...e};return Object.assign(t,{id:e.id,has:e.has,parent_id:e.parent_id,deleted_at:e.deleted_at,created_at:e.created_at,updated_at:((a=e.latest)==null?void 0:a.created_at)||e.updated_at,editor:((s=e.latest)==null?void 0:s.editor)||e.editor,published:((r=e.latest)==null?void 0:r.published)??!0,publish_at:((l=e.latest)==null?void 0:l.publish_at)||null,latest:e.latest})},insert(e,t=null){if(!this.auth.can("page:add")){this.messages.add(this.$gettext("Permission denied"),"error");return}const n=this.$refs.tree.getSiblings(e),a=t!==null?e.parent:e,s=n.indexOf(e),r=this.create();let l=null;switch(t===null&&!e.open&&this.load(e,e.data),t){case 0:l=e.data.id;break;case null:l=e.children&&e.children[0]?e.children[0].data.id:null;break;case 1:l=n[s+1]?n[s+1].data.id:null;break}this.$apollo.mutate({mutation:U`mutation ($input: PageInput!, $parent: ID, $ref: ID) {
            addPage(input: $input, parent: $parent, ref: $ref) {
              id
            }
          }`,variables:{input:r,parent:a?a.data.id:null,ref:l}}).then(i=>{if(i.errors)throw i.errors;r.id=i.data.addPage.id,(t!==null||e.open)&&this.$refs.tree.add(r,a,t!==null?s+t:0),a&&(a.data.has=!0),this.invalidate(),this.submenu()}).catch(i=>{this.messages.add(this.$gettext("Error inserting page")+`:
`+i,"error"),this.$log("PageList::insert(): Error inserting page",i)})},invalidate(){const e=this.$apollo.provider.defaultClient.cache;e.evict({id:"ROOT_QUERY",fieldName:"pages"}),e.gc()},keep(e){if(!this.auth.can("page:keep")){this.messages.add(this.$gettext("Permission denied"),"error");return}const t=e?[e]:this.$refs.tree.statsFlat.filter(s=>s._checked&&s.data.id&&s.data.deleted_at),n=t.filter(s=>t.indexOf(s.parent)===-1),a=e.data.deleted_at||null;n.length&&this.$apollo.mutate({mutation:U`mutation ($id: [ID!]!) {
            keepPage(id: $id) {
              id
            }
          }`,variables:{id:n.map(s=>s.data.id)}}).then(s=>{if(s.errors)throw s.errors;for(const r of n)this.update(r,l=>{a>=l.data.deleted_at&&(l.data.deleted_at=null,l.check=!1)});this.invalidate()}).catch(s=>{this.messages.add(this.$gettext("Error restoring page")+`:
`+s,"error"),this.$log("PageList::keep(): Error restoring page",n,s)})},load(e,t){!e.open&&!t.children&&(e.loading=!0,this.fetch(t.id,e.page?e.page+1:1).then(n=>{this.$refs.tree.addMulti(n.data,e,0),e.page=n.currentPage||1}).finally(()=>{e.loading=!1})),e.open=!e.open},move(e,t=null){if(!this.auth.can("page:move")){this.messages.add(this.$gettext("Permission denied"),"error");return}const n=this.$refs.tree.getSiblings(e),a=t!==null?e.parent:e,s=n.indexOf(e);let r=null;switch(t){case 0:r=e.data.id;break;case null:r=e.children&&e.children[0]?e.children[0].data.id:null;break;case 1:r=n[s+1]?n[s+1].data.id:null;break}this.$apollo.mutate({mutation:U`mutation ($id: ID!, $parent: ID, $ref: ID) {
            movePage(id: $id, parent: $parent, ref: $ref) {
              id
            }
          }`,variables:{id:this.clip.node.id,parent:a?a.data.id:null,ref:r}}).then(l=>{var d;if(l.errors)throw l.errors;const i=t!==null?s<this.$refs.tree.getSiblings(e).indexOf(this.clip.stat)?s+t:s:0;this.$refs.tree.move(this.clip.stat,a,i),a&&((d=this.clip.stat.children)!=null&&d.length||(e.parent.data.has=!1),a.data.has=!0),this.invalidate(),this.submenu()}).catch(l=>{this.messages.add(this.$gettext("Error moving page")+`:
`+l,"error"),this.$log("PageList::move(): Error moving page",e,t,l)})},paste(e,t=null){if(!this.auth.can("page:add")){this.messages.add(this.$gettext("Permission denied"),"error");return}const n=this.$refs.tree.getSiblings(e),a=t!==null?e.parent:e,s=n.indexOf(e),r={...this.clip.node};let l=null;switch(t){case 0:l=e.data.id;break;case null:l=e.children&&e.children[0]?e.children[0].data.id:null;break;case 1:l=n[s+1]?n[s+1].data.id:null;break}return this.$apollo.query({query:U`query($id: ID!) {
            page(id: $id) {
              id
              latest {
                id
                aux
                files {
                  id
                }
                elements {
                  id
                }
              }
            }
          }`,variables:{id:r.id}}).then(i=>{var u,h;if(i.errors)throw i.errors;const d=(h=(u=i==null?void 0:i.data)==null?void 0:u.page)==null?void 0:h.latest,o=JSON.parse((d==null?void 0:d.aux)||"{}");this.$apollo.mutate({mutation:U`mutation ($input: PageInput!, $parent: ID, $ref: ID, $elements: [ID!], $files: [ID!]) {
              addPage(input: $input, parent: $parent, ref: $ref, elements: $elements, files: $files) {
                ${this.fields()}
              }
            }`,variables:{input:{status:0,to:r.to,tag:r.tag,type:r.type,theme:r.theme,lang:r.lang,name:r.name,title:r.title,cache:r.cache,domain:r.domain,related_id:r.id,meta:JSON.stringify((o==null?void 0:o.meta)||{}),config:JSON.stringify((o==null?void 0:o.config)||{}),content:JSON.stringify((o==null?void 0:o.content)||[]),path:r.path+"_"+Math.floor(Math.random()*1e4)},parent:a?a.data.id:null,ref:l,elements:(d==null?void 0:d.elements.map(c=>c.id))||[],files:(d==null?void 0:d.files.map(c=>c.id))||[]}}).then(c=>{if(c.errors)throw c.errors;if(!c.data.addPage)throw new Error("No page data returned");const p=t!==null?this.$refs.tree.getSiblings(e).indexOf(e)+t:0,v=this.hydrate(c.data.addPage);this.$refs.tree.add(v,a,p),this.invalidate(),this.submenu()}).catch(c=>{this.messages.add(this.$gettext("Error copying page")+`:
`+c,"error"),this.$log("PageList::paste(): Error copying page",e,t,c)})}).catch(i=>{this.messages.add(this.$gettext("Error fetching page")+`:
`+i,"error"),this.$log("PageList::paste(): Error fetching page",r.id,i)})},publish(e){if(!this.auth.can("page:publish")){this.messages.add(this.$gettext("Permission denied"),"error");return}const t=e?[e]:this.$refs.tree.statsFlat.filter(n=>n._checked&&n.data.id&&!n.data.published);t.length&&this.$apollo.mutate({mutation:U`mutation ($id: [ID!]!) {
            pubPage(id: $id) {
              id
            }
          }`,variables:{id:t.map(n=>n.data.id)}}).then(n=>{if(n.errors)throw n.errors;for(const a of t)a.data.published=!0,a.check=!1;this.invalidate()}).catch(n=>{this.messages.add(this.$gettext("Error publishing page")+`:
`+n,"error"),this.$log("PageList::publish(): Error publishing page",t,n)})},purge(e){if(!this.auth.can("page:purge")){this.messages.add(this.$gettext("Permission denied"),"error");return}const t=e?[e]:this.$refs.tree.statsFlat.filter(n=>n._checked&&n.data.id);t.length&&this.$apollo.mutate({mutation:U`mutation ($id: [ID!]!) {
            purgePage(id: $id) {
              id
            }
          }`,variables:{id:t.map(n=>n.data.id).reverse()}}).then(n=>{var a;if(n.errors)throw n.errors;for(const s of t)this.$refs.tree.remove(s),s.parent&&!((a=s.parent.children)!=null&&a.length)&&(s.parent.data.has=!1)}).catch(n=>{this.messages.add(this.$gettext("Error purging page")+`:
`+n,"error"),this.$log("PageList::purge(): Error purging page",t,n)})},reload(e=!0){if(this.items=[],this.loading=!0,e){const n=this.$apollo.provider.defaultClient.cache;n.evict({id:"ROOT_QUERY",fieldName:"pages"}),n.gc()}(this.filter.view==="list"?this.search():this.fetch()).then(n=>{this.items=(n==null?void 0:n.data)||[],this.loading=!1})},search(e=1,t=100){if(!this.auth.can("page:view"))return this.messages.add(this.$gettext("Permission denied"),"error"),Promise.resolve([]);const n=this.filter.publish||null,a=this.filter.trashed||"WITHOUT",s={...this.filter};return delete s.trashed,delete s.publish,delete s.view,this.term&&(s.any=this.term),this.$apollo.query({query:U`query($filter: PageFilter, $limit: Int!, $page: Int!, $trashed: Trashed, $publish: Publish) {
            pages(filter: $filter, first: $limit, page: $page, trashed: $trashed, publish: $publish) {
              data {
                ${this.fields()}
              }
              paginatorInfo {
                currentPage
                lastPage
              }
            }
          }`,variables:{filter:s,page:e,limit:t,trashed:a,publish:n}}).then(r=>{if(r.errors)throw r.errors;return this.transform(r.data.pages)}).catch(r=>{this.messages.add(this.$gettext("Error searching pages")+`:
`+r,"error"),this.$log("PageList::search(): Error searching pages",e,t,r)})},status(e,t){if(!this.auth.can("page:save")){this.messages.add(this.$gettext("Permission denied"),"error");return}(e?[e]:this.$refs.tree.statsFlat.filter(a=>a._checked&&a.data.id)).forEach(a=>{this.$apollo.mutate({mutation:U`mutation ($id: ID!, $input: PageInput!) {
              savePage(id: $id, input: $input) {
                id
              }
            }`,variables:{id:a.data.id,input:{status:t}}}).then(s=>{if(s.errors)throw s.errors;a.data.status=t}).catch(s=>{this.messages.add(this.$gettext("Error saving page")+`:
`+s,"error"),this.$log("PageList::status(): Error saving page",a,t,s)})})},submenu(e=null){e?this.menu[e]=!this.menu[e]:this.menu={}},title(e){const t=[];return e.publish_at&&t.push("Publish at: "+new Date(e.publish_at).toLocaleDateString()),e.theme&&t.push("Theme: "+e.theme),e.type&&t.push("Page type: "+e.type),e.tag&&t.push("Tag: "+e.tag),e.cache&&t.push("Cache: "+e.cache+" min"),t.join(`
`)},toggle(){this.$refs.tree.statsFlat.forEach(e=>{e._checked=!e._checked})},transform(e){return{data:e.data.map(n=>this.hydrate(n)),currentPage:e.paginatorInfo.currentPage,lastPage:e.paginatorInfo.lastPage}},update(e,t){var n;if(typeof t!="function")throw new Error("Second paramter must be a function");t(e),(n=e.children)==null||n.forEach(a=>{t(a,t)})},url(e){return this.app.urlpage.replace(/_domain_/,e.domain||"").replace(/_path_/,e.path||"").replace(/\/+$/,"")}},watch:{filter:{deep:!0,handler(e){this.items=[],this.loading=!0,(e.view==="list"?this.search():this.fetch()).then(n=>{this.items=(n==null?void 0:n.data)||[],this.loading=!1})}},term:{handler(){this.reload(!1)}}}},En={class:"header"},On={class:"bulk"},Pn={class:"search"},Ln={class:"actions"},Tn={key:0,class:"spinner",fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},In=["title"],Nn=["onClick"],Fn={class:"item-head"},An={key:0,class:"item-lang"},Bn={class:"item-title"},Vn={key:0,class:"item-subtitle"},Hn=["href"],Kn={class:"item-domain"},Un={class:"item-path item-subtitle"},zn={key:0,class:"item-to item-subtitle"},Mn={key:0,class:"loading"},Rn={key:1,class:"notfound"},jn={key:2,class:"btn-group"};function Wn(e,t,n,a,s,r){const l=re("Draggable");return y(),N(ue,null,[P("div",En,[P("div",On,[f(Je,{modelValue:s.checked,"onUpdate:modelValue":t[0]||(t[0]=i=>s.checked=i),onClick:t[1]||(t[1]=_e(i=>r.toggle(),["stop"]))},null,8,["modelValue"]),f(Ze,{location:"bottom left"},{activator:g(({props:i})=>[f(S,Qe({"append-icon":"mdi-menu-down",variant:"text"},i,{disabled:!r.isChecked}),{default:g(()=>[O(D(e.$gettext("Actions")),1)]),_:1},16,["disabled"])]),default:g(()=>[f(Ge,null,{default:g(()=>[r.isChecked&&a.auth.can("page:publish")?(y(),_(I,{key:0},{default:g(()=>[f(S,{"prepend-icon":"mdi-publish",variant:"text",onClick:t[2]||(t[2]=i=>r.publish())},{default:g(()=>[O(D(e.$gettext("Publish")),1)]),_:1})]),_:1})):x("",!0),r.isChecked&&a.auth.can("page:save")?(y(),_(I,{key:1},{default:g(()=>[f(S,{"prepend-icon":"mdi-eye",variant:"text",onClick:t[3]||(t[3]=i=>r.status(null,1))},{default:g(()=>[O(D(e.$gettext("Enable")),1)]),_:1})]),_:1})):x("",!0),r.isChecked&&a.auth.can("page:save")?(y(),_(I,{key:2},{default:g(()=>[f(S,{"prepend-icon":"mdi-eye-off",variant:"text",onClick:t[4]||(t[4]=i=>r.status(null,0))},{default:g(()=>[O(D(e.$gettext("Disable")),1)]),_:1})]),_:1})):x("",!0),f(He),r.canTrash&&a.auth.can("page:drop")?(y(),_(I,{key:3},{default:g(()=>[f(S,{"prepend-icon":"mdi-delete",variant:"text",onClick:t[5]||(t[5]=i=>r.drop())},{default:g(()=>[O(D(e.$gettext("Delete")),1)]),_:1})]),_:1})):x("",!0),r.isTrashed&&a.auth.can("page:keep")?(y(),_(I,{key:4},{default:g(()=>[f(S,{"prepend-icon":"mdi-delete-restore",variant:"text",onClick:t[6]||(t[6]=i=>r.keep())},{default:g(()=>[O(D(e.$gettext("Restore")),1)]),_:1})]),_:1})):x("",!0),r.isChecked&&a.auth.can("page:purge")?(y(),_(I,{key:5},{default:g(()=>[f(S,{"prepend-icon":"mdi-delete-forever",variant:"text",onClick:t[7]||(t[7]=i=>r.purge())},{default:g(()=>[O(D(e.$gettext("Purge")),1)]),_:1})]),_:1})):x("",!0)]),_:1})]),_:1})]),P("div",Pn,[f(Ct,{modelValue:s.term,"onUpdate:modelValue":t[8]||(t[8]=i=>s.term=i),label:e.$gettext("Search for"),"prepend-inner-icon":"mdi-magnify",variant:"underlined","hide-details":"",clearable:""},null,8,["modelValue","label"])]),f(S,{onClick:t[9]||(t[9]=i=>r.reload()),title:e.$gettext("Reload page tree"),icon:"mdi-refresh",variant:"text",class:"no-rtl"},null,8,["title"])]),f(l,{ref:"tree",modelValue:s.items,"onUpdate:modelValue":t[13]||(t[13]=i=>s.items=i),onChange:t[14]||(t[14]=i=>r.change()),defaultOpen:!1,disableDrag:!a.auth.can("page:move"),rtl:e.$vuetify.locale.isRtl,watermark:!1,virtualization:""},{default:g(({node:i,stat:d})=>[P("div",Ln,[d.loading?(y(),N("svg",Tn,[...t[16]||(t[16]=[P("circle",{class:"spin1",cx:"4",cy:"12",r:"3"},null,-1),P("circle",{class:"spin1 spin2",cx:"12",cy:"12",r:"3"},null,-1),P("circle",{class:"spin1 spin3",cx:"20",cy:"12",r:"3"},null,-1)])])):(y(),_(S,{key:1,onClick:o=>r.load(d,i),class:pe({hidden:!i.has&&!d.children.length}),icon:d.open?"mdi-menu-down":"mdi-menu-right",title:e.$gettext("Toggle child nodes"),variant:"text"},null,8,["onClick","class","icon","title"])),f(Je,{modelValue:d._checked,"onUpdate:modelValue":o=>d._checked=o,class:pe({draft:!i.published})},null,8,["modelValue","onUpdate:modelValue","class"]),i.id?(y(),_(Ze,{key:2},{activator:g(({props:o})=>[f(S,Qe(o,{title:e.$gettext("Actions"),icon:"mdi-dots-vertical",variant:"text"}),null,16,["title"])]),default:g(()=>[f(Ge,null,{default:g(()=>[!i.deleted_at&&!i.published&&a.auth.can("page:publish")?(y(),_(I,{key:0},{default:g(()=>[f(S,{"prepend-icon":"mdi-publish",variant:"text",onClick:o=>r.publish(d)},{default:g(()=>[O(D(e.$gettext("Publish")),1)]),_:1},8,["onClick"])]),_:2},1024)):x("",!0),i.status!==0&&a.auth.can("page:save")?(y(),_(I,{key:1},{default:g(()=>[f(S,{"prepend-icon":"mdi-eye-off",variant:"text",onClick:o=>r.status(d,0)},{default:g(()=>[O(D(e.$gettext("Disable")),1)]),_:1},8,["onClick"])]),_:2},1024)):x("",!0),i.status!==1&&a.auth.can("page:save")?(y(),_(I,{key:2},{default:g(()=>[f(S,{"prepend-icon":"mdi-eye",variant:"text",onClick:o=>r.status(d,1)},{default:g(()=>[O(D(e.$gettext("Enable")),1)]),_:1},8,["onClick"])]),_:2},1024)):x("",!0),i.status!==2&&a.auth.can("page:save")?(y(),_(I,{key:3},{default:g(()=>[f(S,{"prepend-icon":"mdi-eye-off-outline",variant:"text",onClick:o=>r.status(d,2)},{default:g(()=>[O(D(e.$gettext("Hide")),1)]),_:1},8,["onClick"])]),_:2},1024)):x("",!0),f(He),a.auth.can("page:move")?(y(),_(I,{key:4},{default:g(()=>[f(S,{"prepend-icon":"mdi-content-cut",variant:"text",onClick:o=>r.cut(d,i)},{default:g(()=>[O(D(e.$gettext("Cut")),1)]),_:1},8,["onClick"])]),_:2},1024)):x("",!0),!this.embed&&a.auth.can("page:add")?(y(),_(I,{key:5},{default:g(()=>[f(S,{"prepend-icon":"mdi-content-copy",variant:"text",onClick:o=>r.copy(d,i)},{default:g(()=>[O(D(e.$gettext("Copy")),1)]),_:1},8,["onClick"])]),_:2},1024)):x("",!0),s.clip&&s.clip.type=="copy"&&!this.embed&&a.auth.can("page:add")?(y(),_(I,{key:6},{default:g(()=>[f(S,{"prepend-icon":"mdi-content-paste",variant:"text",onClick:t[10]||(t[10]=_e(o=>r.submenu("paste"),["stop"]))},{default:g(()=>[O(D(e.$gettext("Paste")),1)]),_:1})]),_:1})):x("",!0),s.clip&&s.clip.type=="copy"&&s.menu.paste&&!this.embed&&a.auth.can("page:add")?(y(),_(te,{key:7},{default:g(()=>[f(I,null,{default:g(()=>[f(S,{"prepend-icon":"mdi-arrow-up",variant:"text",onClick:o=>r.paste(d,0),class:"subitem"},{default:g(()=>[O(D(e.$gettext("Before")),1)]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)):x("",!0),s.clip&&s.clip.type=="copy"&&s.menu.paste&&!this.embed&&a.auth.can("page:add")?(y(),_(te,{key:8},{default:g(()=>[f(I,null,{default:g(()=>[f(S,{"prepend-icon":"mdi-arrow-right",variant:"text",onClick:o=>r.paste(d),class:"subitem"},{default:g(()=>[O(D(e.$gettext("Into")),1)]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)):x("",!0),s.clip&&s.clip.type=="copy"&&s.menu.paste&&!this.embed&&a.auth.can("page:add")?(y(),_(te,{key:9},{default:g(()=>[f(I,null,{default:g(()=>[f(S,{"prepend-icon":"mdi-arrow-down",variant:"text",onClick:o=>r.paste(d,1),class:"subitem"},{default:g(()=>[O(D(e.$gettext("After")),1)]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)):x("",!0),s.clip&&s.clip.type=="cut"&&a.auth.can("page:move")?(y(),_(I,{key:10},{default:g(()=>[f(S,{"prepend-icon":"mdi-content-paste",variant:"text",onClick:t[11]||(t[11]=_e(o=>r.submenu("move"),["stop"]))},{default:g(()=>[O(D(e.$gettext("Paste")),1)]),_:1})]),_:1})):x("",!0),s.clip&&s.clip.type=="cut"&&s.menu.move&&a.auth.can("page:move")?(y(),_(te,{key:11},{default:g(()=>[f(I,null,{default:g(()=>[f(S,{"prepend-icon":"mdi-arrow-up",variant:"text",onClick:o=>r.move(d,0),class:"subitem"},{default:g(()=>[O(D(e.$gettext("Before")),1)]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)):x("",!0),s.clip&&s.clip.type=="cut"&&s.menu.move&&a.auth.can("page:move")?(y(),_(te,{key:12},{default:g(()=>[f(I,null,{default:g(()=>[f(S,{"prepend-icon":"mdi-arrow-right",variant:"text",onClick:o=>r.move(d),class:"subitem"},{default:g(()=>[O(D(e.$gettext("Into")),1)]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)):x("",!0),s.clip&&s.clip.type=="cut"&&s.menu.move&&a.auth.can("page:move")?(y(),_(te,{key:13},{default:g(()=>[f(I,null,{default:g(()=>[f(S,{"prepend-icon":"mdi-arrow-down",variant:"text",onClick:o=>r.move(d,1),class:"subitem"},{default:g(()=>[O(D(e.$gettext("After")),1)]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)):x("",!0),!this.embed&&a.auth.can("page:add")?(y(),_(I,{key:14},{default:g(()=>[f(S,{"prepend-icon":"mdi-content-paste",variant:"text",onClick:t[12]||(t[12]=_e(o=>r.submenu("insert"),["stop"]))},{default:g(()=>[O(D(e.$gettext("Insert")),1)]),_:1})]),_:1})):x("",!0),s.menu.insert&&!this.embed&&a.auth.can("page:add")?(y(),_(te,{key:15},{default:g(()=>[f(I,null,{default:g(()=>[f(S,{"prepend-icon":"mdi-arrow-up",variant:"text",onClick:o=>r.insert(d,0),class:"subitem"},{default:g(()=>[O(D(e.$gettext("Before")),1)]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)):x("",!0),s.menu.insert&&!this.embed&&a.auth.can("page:add")?(y(),_(te,{key:16},{default:g(()=>[f(I,null,{default:g(()=>[f(S,{"prepend-icon":"mdi-arrow-right",variant:"text",onClick:o=>r.insert(d),class:"subitem"},{default:g(()=>[O(D(e.$gettext("Into")),1)]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)):x("",!0),s.menu.insert&&!this.embed&&a.auth.can("page:add")?(y(),_(te,{key:17},{default:g(()=>[f(I,null,{default:g(()=>[f(S,{"prepend-icon":"mdi-arrow-down",variant:"text",onClick:o=>r.insert(d,1),class:"subitem"},{default:g(()=>[O(D(e.$gettext("After")),1)]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)):x("",!0),f(He),!i.deleted_at&&a.auth.can("page:drop")?(y(),_(I,{key:18},{default:g(()=>[f(S,{"prepend-icon":"mdi-delete",variant:"text",onClick:o=>r.drop(d)},{default:g(()=>[O(D(e.$gettext("Delete")),1)]),_:1},8,["onClick"])]),_:2},1024)):x("",!0),i.deleted_at&&a.auth.can("page:keep")?(y(),_(I,{key:19},{default:g(()=>[f(S,{"prepend-icon":"mdi-delete-restore",variant:"text",onClick:o=>r.keep(d)},{default:g(()=>[O(D(e.$gettext("Restore")),1)]),_:1},8,["onClick"])]),_:2},1024)):x("",!0),a.auth.can("page:purge")?(y(),_(I,{key:20},{default:g(()=>[f(S,{"prepend-icon":"mdi-delete-forever",variant:"text",onClick:o=>r.purge(d)},{default:g(()=>[O(D(e.$gettext("Purge")),1)]),_:1},8,["onClick"])]),_:2},1024)):x("",!0)]),_:2},1024)]),_:2},1024)):x("",!0)]),P("div",{class:pe(["item-content",{"status-hidden":i.status==2,"status-enabled":i.status==1,"status-disabled":!i.status,trashed:i.deleted_at,cut:d.cut}]),title:r.title(i)},[P("div",{class:"item-text",onClick:o=>e.$emit("select",i)},[P("div",Fn,[i.lang?(y(),N("span",An,D(i.lang),1)):x("",!0),i.publish_at?(y(),_(Le,{key:1,class:"publish-at",icon:"mdi-clock-outline"})):x("",!0),i.status>1?(y(),_(Le,{key:2,class:"item-status",icon:"mdi-eye-off-outline"})):x("",!0),P("span",Bn,D(i.name||e.$gettext("New")),1)]),i.title?(y(),N("div",Vn,D(i.title),1)):x("",!0)],8,Nn),P("a",{class:"item-aux",href:r.url(i),target:"_blank",draggable:"false"},[P("div",Kn,D(i.domain),1),P("span",Un,D(r.url(i)),1),i.to?(y(),N("span",zn," ➔ "+D(i.to),1)):x("",!0)],8,Hn)],10,In)]),_:1},8,["modelValue","disableDrag","rtl"]),s.loading?(y(),N("p",Mn,[O(D(e.$gettext("Loading"))+" ",1),t[17]||(t[17]=P("svg",{class:"spinner",width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},[P("circle",{class:"spin1",cx:"4",cy:"12",r:"3"}),P("circle",{class:"spin1 spin2",cx:"12",cy:"12",r:"3"}),P("circle",{class:"spin1 spin3",cx:"20",cy:"12",r:"3"})],-1))])):x("",!0),!s.loading&&!s.items.length?(y(),N("p",Rn,D(e.$gettext("No entries found")),1)):x("",!0),!s.loading&&!s.items.length&&!this.embed&&this.auth.can("page:add")?(y(),N("div",jn,[f(S,{onClick:t[15]||(t[15]=i=>r.add()),title:e.$gettext("Add page"),icon:"mdi-folder-plus",color:"primary",variant:"flat"},null,8,["title"])])):x("",!0)],64)}const Yn=ut(_n,[["render",Wn]]),Xn={components:{PageListItems:Yn,PageDetail:et,Navigation:Ft,AsideList:Nt,User:It},inject:["locales","openView"],data:()=>({chat:"",response:"",help:!1,shortmsg:!0,synthesizing:!1,filter:{view:"tree",trashed:"WITHOUT",publish:null,status:null,editor:null,cache:null,lang:null}}),setup(){const e=ct(),t=_t();return{auth:ht(),drawer:t,messages:e}},computed:{message(){if(!this.response)return this.chat;const e=this.response.indexOf(`
---
`);return this.shortmsg?this.$pgettext("ai",this.response.slice(0,e)):this.response.substring(e>0?e+5:0)}},methods:{languages(){const e=[{title:this.$gettext("All"),icon:"mdi-playlist-check",value:{lang:null}}];for(const t of this.locales())e.push({title:t.title,icon:"mdi-translate",value:{lang:t.value}});return e},open(e){this.openView(et,{item:e})},same(e,t){if(!e||!t)return!1;const n=Object.keys(e),a=Object.keys(t);return n.length===a.length&&n.every(s=>e[s]===t[s])},synthesize(){const e=this.chat.trim();this.chat&&(this.synthesizing=!0,this.$apollo.mutate({mutation:U`mutation($prompt: String!) {
            synthesize(prompt: $prompt)
          }`,variables:{prompt:e}}).then(t=>{var a,s;if(t.errors)throw t;this.response=((a=t.data)==null?void 0:a.synthesize)||"",this.chat=this.message;const n={view:"list",publish:"DRAFT",trashed:"WITHOUT",editor:(s=this.auth.me)==null?void 0:s.email,cache:null,lang:null,status:0};this.same(n,this.filter)?this.$refs.pagelist.reload():this.filter=n,this.synthesizing=null}).catch(t=>{this.messages.add(this.$gettext("Error synthesizing content")+`:
`+t,"error"),this.$log("PageDetailContentList::synthesize(): Error synthesizing content",t)}).finally(()=>{setTimeout(()=>{this.synthesizing=!1},3e3)}))}}},qn={key:0,fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Jn={key:1,class:"spinner",fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Zn={key:2,fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Gn={key:0,class:"help"};function Qn(e,t,n,a,s,r){var u;const l=re("User"),i=re("Navigation"),d=re("PageListItems"),o=re("AsideList");return y(),N(ue,null,[f(Dt,{elevation:0,density:"compact"},{prepend:g(()=>[f(S,{onClick:t[0]||(t[0]=h=>a.drawer.toggle("nav")),title:a.drawer.nav?e.$gettext("Close navigation"):e.$gettext("Open navigation"),icon:a.drawer.nav?"mdi-close":"mdi-menu"},null,8,["title","icon"])]),append:g(()=>[f(l),f(S,{onClick:t[1]||(t[1]=h=>a.drawer.toggle("aside")),title:e.$gettext("Toggle side menu"),icon:a.drawer.aside?"mdi-chevron-right":"mdi-chevron-left"},null,8,["title","icon"])]),default:g(()=>[f(Et,null,{default:g(()=>[O(D(e.$gettext("Pages")),1)]),_:1})]),_:1}),f(i),f(St,{class:"page-list"},{default:g(()=>[f(Ot,null,{default:g(()=>[f(Pt,{class:"box scroll"},{default:g(()=>[f(Lt,{modelValue:e.chat,"onUpdate:modelValue":t[5]||(t[5]=h=>e.chat=h),loading:e.synthesizing,placeholder:e.$gettext("Describe the page and content you want to create"),onDblclick:t[6]||(t[6]=h=>{e.shortmsg=!e.shortmsg,e.chat=r.message}),variant:"outlined",class:"prompt",rounded:"lg","hide-details":"",autofocus:"","auto-grow":"",clearable:"",outlined:"",rows:"1"},{prepend:g(()=>[f(Le,{onClick:t[2]||(t[2]=h=>e.help=!e.help)},{default:g(()=>[...t[9]||(t[9]=[P("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24"},[P("path",{d:"M15.07,11.25L14.17,12.17C13.45,12.89 13,13.5 13,15H11V14.5C11,13.39 11.45,12.39 12.17,11.67L13.41,10.41C13.78,10.05 14,9.55 14,9C14,7.89 13.1,7 12,7A2,2 0 0,0 10,9H8A4,4 0 0,1 12,5A4,4 0 0,1 16,9C16,9.88 15.64,10.67 15.07,11.25M13,19H11V17H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2Z"})],-1)])]),_:1})]),append:g(()=>[f(Le,{onClick:t[3]||(t[3]=h=>e.synthesizing||r.synthesize()),onKeydown:t[4]||(t[4]=Tt(h=>e.synthesizing||r.synthesize(),["enter"])),title:e.synthesizing?e.$gettext("Generating ..."):e.$gettext("Generate page based on prompt")},{default:g(()=>[e.synthesizing===!1?(y(),N("svg",qn,[...t[10]||(t[10]=[P("path",{d:"M22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2A10,10 0 0,1 22,12M6,13H14L10.5,16.5L11.92,17.92L17.84,12L11.92,6.08L10.5,7.5L14,11H6V13Z"},null,-1)])])):x("",!0),e.synthesizing===!0?(y(),N("svg",Jn,[...t[11]||(t[11]=[P("circle",{class:"spin1",cx:"4",cy:"12",r:"3"},null,-1),P("circle",{class:"spin1 spin2",cx:"12",cy:"12",r:"3"},null,-1),P("circle",{class:"spin1 spin3",cx:"20",cy:"12",r:"3"},null,-1)])])):x("",!0),e.synthesizing===null?(y(),N("svg",Zn,[...t[12]||(t[12]=[P("path",{d:"M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z"},null,-1)])])):x("",!0)]),_:1},8,["title"])]),_:1},8,["modelValue","loading","placeholder"]),e.help?(y(),N("div",Gn,[P("ul",null,[P("li",null,D(e.$gettext("AI can create a page and content based on your input and add it to the page tree")),1),P("li",null,D(e.$gettext("Double click on the response in the input field to display full response")),1)])])):x("",!0),f(d,{ref:"pagelist",onSelect:t[7]||(t[7]=h=>r.open(h)),filter:e.filter},null,8,["filter"])]),_:1})]),_:1})]),_:1}),f(o,{filter:e.filter,"onUpdate:filter":t[8]||(t[8]=h=>e.filter=h),content:[{key:"view",title:e.$gettext("view"),items:[{title:e.$gettext("Tree"),icon:"mdi-file-tree",value:{view:"tree"}},{title:e.$gettext("List"),icon:"mdi-format-list-bulleted-square",value:{view:"list"}}]},{key:"publish",title:e.$gettext("publish"),items:[{title:e.$gettext("All"),icon:"mdi-playlist-check",value:{publish:null}},{title:e.$gettext("Published"),icon:"mdi-publish",value:{publish:"PUBLISHED"}},{title:e.$gettext("Scheduled"),icon:"mdi-clock-outline",value:{publish:"SCHEDULED"}},{title:e.$gettext("Drafts"),icon:"mdi-pencil",value:{publish:"DRAFT"}}]},{key:"trashed",title:e.$gettext("trashed"),items:[{title:e.$gettext("All"),icon:"mdi-playlist-check",value:{trashed:"WITH"}},{title:e.$gettext("Available only"),icon:"mdi-delete-off",value:{trashed:"WITHOUT"}},{title:e.$gettext("Only trashed"),icon:"mdi-delete",value:{trashed:"ONLY"}}]},{key:"status",title:e.$gettext("status"),items:[{title:e.$gettext("All"),icon:"mdi-playlist-check",value:{status:null}},{title:e.$gettext("Enabled"),icon:"mdi-eye",value:{status:1}},{title:e.$gettext("Hidden"),icon:"mdi-eye-off-outline",value:{status:2}},{title:e.$gettext("Disabled"),icon:"mdi-eye-off",value:{status:0}}]},{key:"cache",title:e.$gettext("cache"),items:[{title:e.$gettext("All"),icon:"mdi-playlist-check",value:{cache:null}},{title:e.$gettext("No cache"),icon:"mdi-clock-alert-outline",value:{cache:0}}]},{key:"editor",title:e.$gettext("editor"),items:[{title:e.$gettext("All"),icon:"mdi-playlist-check",value:{editor:null}},{title:e.$gettext("Edited by me"),icon:"mdi-account",value:{editor:(u=this.auth.me)==null?void 0:u.email}}]},{key:"lang",title:e.$gettext("languages"),items:r.languages()}]},null,8,["filter","content"])],64)}const sa=ut(Xn,[["render",Qn],["__scopeId","data-v-6c4e6f34"]]);export{sa as default};
