import{s as U}from"./vue-draggable-plus-BNT-0twj.js";import{_ as D,c as m,f as d,ah as w,ai as T,F as b,a5 as H,o as s,a as l,b as V,d as p,w as t,k as u,ac as y,ad as M,ae as _,l as c,t as h,i as x,j as f,m as I,ab as $,a1 as A}from"./index-BPV2UoEN.js";const R={directives:{draggable:U},props:{modelValue:{type:Array,default:()=>[]},config:{type:Object,default:()=>({})},readonly:{type:Boolean,default:!1},context:{type:Object}},emits:["update:modelValue","error"],inject:["debounce"],data(){return{columns:this.header(),table:this.modelValue,validated:null,updated:null,menu:{}}},created(){if(!this.table.length)return this.$emit("update:modelValue",this.config.default??[[""]]);this.validated=this.debounce(this.validate,500),this.updated=this.debounce(this.update,500)},computed:{cols(){return this.columns.filter(e=>!!e)},rules(){return[e=>!this.config.min||+(e==null?void 0:e.length)>=+this.config.min||this.$gettext("Minimum are %{num} columns",{num:this.config.min}),e=>!this.config.max||+(e==null?void 0:e.length)<=+this.config.max||this.$gettext("Maximum are %{num} columns",{num:this.config.max})]}},methods:{addCol(e){this.columns.splice(e+1,0,!0),this.table.forEach(a=>a.splice(e,0,"")),this.$emit("update:modelValue",this.table)},addRow(e){this.table.splice(e,0,this.cols.map(()=>"")),this.$emit("update:modelValue",this.table)},header(){const e=(this.modelValue[0]||[]).map((a,g)=>!0);return e.unshift(null),e.push(null),e},move(e){e.oldIndex!==e.newIndex&&(this.table.forEach(a=>{a.splice(e.newIndex-1,0,a.splice(e.oldIndex-1,1)[0])}),this.$emit("update:modelValue",this.table))},rmCol(e){this.cols.length<=1||(this.columns.splice(e,1),this.table.forEach(a=>a.splice(e,1)),this.$emit("update:modelValue",this.table))},rmRow(e){this.table.length<=1||(this.table.splice(e,1),this.$emit("update:modelValue",this.table))},update(){this.$emit("update:modelValue",this.table)},validate(e){this.$emit("error",!this.rules.every(a=>a(e)===!0))}},watch:{modelValue:{handler(e){this.table=e,this.validated?this.validated(e):this.validate(e),this.columns=this.header()}}}},j={class:"table-wrapper"},E={class:"col-header"};function N(e,a,g,L,o,r){const k=T("draggable");return s(),m("div",j,[d("table",null,[d("thead",null,[w((s(),m("tr",E,[a[2]||(a[2]=d("td",null,null,-1)),(s(!0),m(b,null,H(r.cols,(B,n)=>(s(),m("td",{key:n},[l(u,{variant:"text",class:"col-handle cursor-move",icon:""},{default:t(()=>[...a[1]||(a[1]=[d("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",width:"24",viewBox:"0 0 24 24",fill:"currentColor"},[d("path",{d:"M3,15V13H5V15H3M3,11V9H5V11H3M7,15V13H9V15H7M7,11V9H9V11H7M11,15V13H13V15H11M11,11V9H13V11H11M15,15V13H17V15H15M15,11V9H17V11H15M19,15V13H21V15H19M19,11V9H21V11H19Z"})],-1)])]),_:1}),g.readonly?p("",!0):(s(),V($(e.$vuetify.display.xs?"v-dialog":"v-menu"),{key:0,modelValue:o.menu["col-"+n],"onUpdate:modelValue":i=>o.menu["col-"+n]=i,transition:"scale-transition",location:"start center","max-width":"300"},{activator:t(({props:i})=>[l(u,I({ref_for:!0},i,{title:e.$gettext("Actions"),icon:"mdi-dots-vertical",variant:"text"}),null,16,["title"])]),default:t(()=>[l(y,null,{default:t(()=>[l(M,{density:"compact"},{default:t(()=>[l(_,null,{default:t(()=>[c(h(e.$gettext("Actions")),1)]),_:1}),l(u,{icon:"mdi-close",onClick:i=>o.menu["col-"+n]=!1},null,8,["onClick"])]),_:2},1024),l(x,{onClick:i=>o.menu["col-"+n]=!1},{default:t(()=>[l(f,null,{default:t(()=>[l(u,{"prepend-icon":"mdi-table-column-plus-before",variant:"text",onClick:i=>r.addCol(n)},{default:t(()=>[c(h(e.$gettext("Insert before")),1)]),_:1},8,["onClick"])]),_:2},1024),l(f,null,{default:t(()=>[l(u,{"prepend-icon":"mdi-table-column-plus-after",variant:"text",onClick:i=>r.addCol(n+1)},{default:t(()=>[c(h(e.$gettext("Insert after")),1)]),_:1},8,["onClick"])]),_:2},1024),r.cols.length>1?(s(),V(f,{key:0},{default:t(()=>[l(u,{"prepend-icon":"mdi-delete",variant:"text",onClick:i=>r.rmCol(n)},{default:t(()=>[c(h(e.$gettext("Delete")),1)]),_:1},8,["onClick"])]),_:2},1024)):p("",!0)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"]))]))),128)),a[3]||(a[3]=d("td",null,null,-1))])),[[k,[o.columns,{animation:300,handle:".col-handle",onUpdate:r.move}]]])]),w((s(),m("tbody",null,[(s(!0),m(b,null,H(o.table,(B,n)=>(s(),m("tr",{key:n},[d("td",null,[l(u,{icon:"mdi-drag-horizontal",variant:"text",class:"row-handle cursor-move"},{default:t(()=>[...a[4]||(a[4]=[d("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",width:"24",viewBox:"0 0 24 24",fill:"currentColor"},[d("path",{d:"M9,3H11V5H9V3M13,3H15V5H13V3M9,7H11V9H9V7M13,7H15V9H13V7M9,11H11V13H9V11M13,11H15V13H13V11M9,15H11V17H9V15M13,15H15V17H13V15M9,19H11V21H9V19M13,19H15V21H13V19Z"})],-1)])]),_:1})]),(s(!0),m(b,null,H(r.cols,(i,v)=>(s(),m("td",{key:v},[l(A,{modelValue:o.table[n][v],"onUpdate:modelValue":C=>o.table[n][v]=C,onInput:a[0]||(a[0]=C=>o.updated()),variant:"plain",rows:"1","auto-grow":"","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]))),128)),d("td",null,[g.readonly?p("",!0):(s(),V($(e.$vuetify.display.xs?"v-dialog":"v-menu"),{key:0,modelValue:o.menu["row-"+n],"onUpdate:modelValue":i=>o.menu["row-"+n]=i,transition:"scale-transition",location:"start center","max-width":"300"},{activator:t(({props:i})=>[l(u,I({ref_for:!0},i,{title:e.$gettext("Actions"),icon:"mdi-dots-vertical",variant:"text"}),null,16,["title"])]),default:t(()=>[l(y,null,{default:t(()=>[l(M,{density:"compact"},{default:t(()=>[l(_,null,{default:t(()=>[c(h(e.$gettext("Actions")),1)]),_:1}),l(u,{icon:"mdi-close",onClick:i=>o.menu["row-"+n]=!1},null,8,["onClick"])]),_:2},1024),l(x,{onClick:i=>o.menu["row-"+n]=!1},{default:t(()=>[l(f,null,{default:t(()=>[l(u,{"prepend-icon":"mdi-table-row-plus-before",variant:"text",onClick:i=>r.addRow(n)},{default:t(()=>[c(h(e.$gettext("Insert before")),1)]),_:1},8,["onClick"])]),_:2},1024),l(f,null,{default:t(()=>[l(u,{"prepend-icon":"mdi-table-row-plus-after",variant:"text",onClick:i=>r.addRow(n+1)},{default:t(()=>[c(h(e.$gettext("Insert after")),1)]),_:1},8,["onClick"])]),_:2},1024),o.table.length>1?(s(),V(f,{key:0},{default:t(()=>[l(u,{"prepend-icon":"mdi-delete",variant:"text",onClick:i=>r.rmRow(n)},{default:t(()=>[c(h(e.$gettext("Delete")),1)]),_:1},8,["onClick"])]),_:2},1024)):p("",!0)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"]))])]))),128))])),[[k,[o.table,{animation:300,handle:".row-handle"}]]])])])}const Z=D(R,[["render",N],["__scopeId","data-v-34fc48e6"]]);export{Z as default};
