import{s as $}from"./vue-draggable-plus-BuDKqo2a.js";import{_ as I,c as u,o as i,f as o,am as v,an as B,F as p,a5 as g,a,w as l,k as d,i as w,b as M,d as k,j as c,l as h,t as V,m as _,h as x,a1 as D}from"./index-BbU18Jta.js";const R={directives:{draggable:$},props:{modelValue:{type:Array,default:()=>[]},config:{type:Object,default:()=>({})},readonly:{type:Boolean,default:!1},context:{type:Object}},emits:["update:modelValue","error"],inject:["debounce"],data(){return{columns:this.header(),table:this.modelValue,validated:null,updated:null}},created(){if(!this.table.length)return this.$emit("update:modelValue",this.config.default??[[""]]);this.validated=this.debounce(this.validate,500),this.updated=this.debounce(this.update,500)},computed:{cols(){return this.columns.filter(e=>!!e)},rules(){return[e=>!this.config.min||+(e==null?void 0:e.length)>=+this.config.min||this.$gettext("Minimum are %{num} columns",{num:this.config.min}),e=>!this.config.max||+(e==null?void 0:e.length)<=+this.config.max||this.$gettext("Maximum are %{num} columns",{num:this.config.max})]}},methods:{addCol(e){this.columns.splice(e+1,0,!0),this.table.forEach(t=>t.splice(e,0,"")),this.$emit("update:modelValue",this.table)},addRow(e){this.table.splice(e,0,this.cols.map(()=>"")),this.$emit("update:modelValue",this.table)},header(){const e=(this.modelValue[0]||[]).map((t,C)=>!0);return e.unshift(null),e.push(null),e},move(e){e.oldIndex!==e.newIndex&&(this.table.forEach(t=>{t.splice(e.newIndex-1,0,t.splice(e.oldIndex-1,1)[0])}),this.$emit("update:modelValue",this.table))},rmCol(e){this.cols.length<=1||(this.columns.splice(e,1),this.table.forEach(t=>t.splice(e,1)),this.$emit("update:modelValue",this.table))},rmRow(e){this.table.length<=1||(this.table.splice(e,1),this.$emit("update:modelValue",this.table))},update(){this.$emit("update:modelValue",this.table)},validate(e){this.$emit("error",!this.rules.every(t=>t(e)===!0))}},watch:{modelValue:{handler(e){this.table=e,this.validated?this.validated(e):this.validate(e),this.columns=this.header()}}}},j={class:"table-wrapper"},E={class:"col-header"};function N(e,t,C,A,m,s){const b=B("draggable");return i(),u("div",j,[o("table",null,[o("thead",null,[v((i(),u("tr",E,[t[2]||(t[2]=o("td",null,null,-1)),(i(!0),u(p,null,g(s.cols,(y,n)=>(i(),u("td",{key:n},[a(d,{variant:"text",class:"col-handle cursor-move"},{default:l(()=>[...t[1]||(t[1]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",width:"24",viewBox:"0 0 24 24"},[o("path",{d:"M3,15V13H5V15H3M3,11V9H5V11H3M7,15V13H9V15H7M7,11V9H9V11H7M11,15V13H13V15H11M11,11V9H13V11H11M15,15V13H17V15H15M15,11V9H17V11H15M19,15V13H21V15H19M19,11V9H21V11H19Z"})],-1)])]),_:1}),a(x,{location:"center"},{activator:l(({props:r})=>[a(d,_({ref_for:!0},r,{title:e.$gettext("Actions"),icon:"mdi-dots-vertical",variant:"text"}),null,16,["title"])]),default:l(()=>[a(w,null,{default:l(()=>[a(c,null,{default:l(()=>[a(d,{"prepend-icon":"mdi-table-column-plus-before",variant:"text",onClick:r=>s.addCol(n)},{default:l(()=>[h(V(e.$gettext("Insert before")),1)]),_:1},8,["onClick"])]),_:2},1024),a(c,null,{default:l(()=>[a(d,{"prepend-icon":"mdi-table-column-plus-after",variant:"text",onClick:r=>s.addCol(n+1)},{default:l(()=>[h(V(e.$gettext("Insert after")),1)]),_:1},8,["onClick"])]),_:2},1024),s.cols.length>1?(i(),M(c,{key:0},{default:l(()=>[a(d,{"prepend-icon":"mdi-delete",variant:"text",onClick:r=>s.rmCol(n)},{default:l(()=>[h(V(e.$gettext("Delete")),1)]),_:1},8,["onClick"])]),_:2},1024)):k("",!0)]),_:2},1024)]),_:2},1024)]))),128)),t[3]||(t[3]=o("td",null,null,-1))])),[[b,[m.columns,{animation:300,handle:".col-handle",onUpdate:s.move}]]])]),v((i(),u("tbody",null,[(i(!0),u(p,null,g(m.table,(y,n)=>(i(),u("tr",{key:n},[o("td",null,[a(d,{icon:"mdi-drag-horizontal",variant:"text",class:"row-handle cursor-move"},{default:l(()=>[...t[4]||(t[4]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",width:"24",viewBox:"0 0 24 24"},[o("path",{d:"M9,3H11V5H9V3M13,3H15V5H13V3M9,7H11V9H9V7M13,7H15V9H13V7M9,11H11V13H9V11M13,11H15V13H13V11M9,15H11V17H9V15M13,15H15V17H13V15M9,19H11V21H9V19M13,19H15V21H13V19Z"})],-1)])]),_:1})]),(i(!0),u(p,null,g(s.cols,(r,f)=>(i(),u("td",{key:f},[a(D,{modelValue:m.table[n][f],"onUpdate:modelValue":H=>m.table[n][f]=H,onInput:t[0]||(t[0]=H=>m.updated()),variant:"plain",rows:"1","auto-grow":"","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]))),128)),o("td",null,[a(x,{location:"center"},{activator:l(({props:r})=>[a(d,_({ref_for:!0},r,{title:e.$gettext("Actions"),icon:"mdi-dots-vertical",variant:"text"}),null,16,["title"])]),default:l(()=>[a(w,null,{default:l(()=>[a(c,null,{default:l(()=>[a(d,{"prepend-icon":"mdi-table-row-plus-before",variant:"text",onClick:r=>s.addRow(n)},{default:l(()=>[h(V(e.$gettext("Insert before")),1)]),_:1},8,["onClick"])]),_:2},1024),a(c,null,{default:l(()=>[a(d,{"prepend-icon":"mdi-table-row-plus-after",variant:"text",onClick:r=>s.addRow(n+1)},{default:l(()=>[h(V(e.$gettext("Insert after")),1)]),_:1},8,["onClick"])]),_:2},1024),m.table.length>1?(i(),M(c,{key:0},{default:l(()=>[a(d,{"prepend-icon":"mdi-delete",variant:"text",onClick:r=>s.rmRow(n)},{default:l(()=>[h(V(e.$gettext("Delete")),1)]),_:1},8,["onClick"])]),_:2},1024)):k("",!0)]),_:2},1024)]),_:2},1024)])]))),128))])),[[b,[m.table,{animation:300,handle:".row-handle"}]]])])])}const U=I(R,[["render",N],["__scopeId","data-v-ea8b2e69"]]);export{U as default};
